var rrweb=function(q){"use strict";var M;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(M||(M={}));function St(e){return e.nodeType===e.ELEMENT_NODE}function De(e){var t=e?.host;return Boolean(t?.shadowRoot===e)}function Re(e){return Object.prototype.toString.call(e)==="[object ShadowRoot]"}var Xe=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(t){var n;if(!t)return-1;var r=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return r??-1},e.prototype.getNode=function(t){return this.idNodeMap.get(t)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(t){return this.nodeMetaMap.get(t)||null},e.prototype.removeNodeFromMap=function(t){var n=this,r=this.getId(t);this.idNodeMap.delete(r),t.childNodes&&t.childNodes.forEach(function(o){return n.removeNodeFromMap(o)})},e.prototype.has=function(t){return this.idNodeMap.has(t)},e.prototype.hasNode=function(t){return this.nodeMetaMap.has(t)},e.prototype.add=function(t,n){var r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)},e.prototype.replace=function(t,n){this.idNodeMap.set(t,n)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function wt(){return new Xe}function Ze(e){var t=e.maskInputOptions,n=e.tagName,r=e.type,o=e.value,i=e.maskInputFn,l=o||"";return(t[n.toLowerCase()]||t[r])&&(i?l=i(l):l="*".repeat(l.length)),l}var Nt="__rrweb_original__";function jn(e){var t=e.getContext("2d");if(!t)return!0;for(var n=50,r=0;r<e.width;r+=n)for(var o=0;o<e.height;o+=n){var i=t.getImageData,l=Nt in i?i[Nt]:i,a=new Uint32Array(l.call(t,r,o,Math.min(n,e.width-r),Math.min(n,e.height-o)).data.buffer);if(a.some(function(c){return c!==0}))return!1}return!0}var Bn=1,zn=new RegExp("[^a-z0-9-_:]"),ke=-2;function Yn(){return Bn++}function Hn(e){if(e instanceof HTMLFormElement)return"form";var t=e.tagName.toLowerCase().trim();return zn.test(t)?"div":t}function Ke(e){try{var t=e.rules||e.cssRules;return t?Array.from(t).map(Xn).join(""):null}catch{return null}}function Xn(e){var t=e.cssText;if(Zn(e))try{t=Ke(e.styleSheet)||t}catch{}return t}function Zn(e){return"styleSheet"in e}function Kn(e){return e.cssRules?Array.from(e.cssRules).map(function(t){return t.cssText||""}).join(""):""}function Qn(e){var t="";return e.indexOf("//")>-1?t=e.split("/").slice(0,3).join("/"):t=e.split("/")[0],t=t.split("?")[0],t}var ge,Tt,qn=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,Jn=/^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/|#).*/,er=/^(data:)([^,]*),(.*)/i;function $e(e,t){return(e||"").replace(qn,function(n,r,o,i,l,a){var c=o||l||a,s=r||i||"";if(!c)return n;if(!Jn.test(c)||er.test(c))return"url(".concat(s).concat(c).concat(s,")");if(c[0]==="/")return"url(".concat(s).concat(Qn(t)+c).concat(s,")");var u=t.split("/"),d=c.split("/");u.pop();for(var m=0,h=d;m<h.length;m++){var f=h[m];f!=="."&&(f===".."?u.pop():u.push(f))}return"url(".concat(s).concat(u.join("/")).concat(s,")")})}var tr=/^[^ \t\n\r\u000c]+/,nr=/^[, \t\n\r\u000c]+/;function rr(e,t){if(t.trim()==="")return t;var n=0;function r(s){var u,d=s.exec(t.substring(n));return d?(u=d[0],n+=u.length,u):""}for(var o=[];r(nr),!(n>=t.length);){var i=r(tr);if(i.slice(-1)===",")i=Ve(e,i.substring(0,i.length-1)),o.push(i);else{var l="";i=Ve(e,i);for(var a=!1;;){var c=t.charAt(n);if(c===""){o.push((i+l).trim());break}else if(a)c===")"&&(a=!1);else if(c===","){n+=1,o.push((i+l).trim());break}else c==="("&&(a=!0);l+=c,n+=1}}}return o.join(", ")}function Ve(e,t){if(!t||t.trim()==="")return t;var n=e.createElement("a");return n.href=t,n.href}function or(e){return Boolean(e.tagName==="svg"||e.ownerSVGElement)}function Qe(){var e=document.createElement("a");return e.href="",e.href}function Et(e,t,n,r){return n==="src"||n==="href"&&r&&!(t==="use"&&r[0]==="#")||n==="xlink:href"&&r&&r[0]!=="#"||n==="background"&&r&&(t==="table"||t==="td"||t==="th")?Ve(e,r):n==="srcset"&&r?rr(e,r):n==="style"&&r?$e(r,Qe()):t==="object"&&n==="data"&&r?Ve(e,r):r}function sr(e,t,n){if(typeof t=="string"){if(e.classList.contains(t))return!0}else for(var r=e.classList.length;r--;){var o=e.classList[r];if(t.test(o))return!0}return n?e.matches(n):!1}function Ue(e,t,n){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return n?Ue(e.parentNode,t,n):!1;for(var r=e.classList.length;r--;){var o=e.classList[r];if(t.test(o))return!0}return n?Ue(e.parentNode,t,n):!1}function Ct(e,t,n){var r=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(r===null)return!1;if(typeof t=="string"){if(r.classList.contains(t)||r.closest(".".concat(t)))return!0}else if(Ue(r,t,!0))return!0;return!!(n&&(r.matches(n)||r.closest(n)))}function ir(e,t,n){var r=e.contentWindow;if(r){var o=!1,i;try{i=r.document.readyState}catch{return}if(i!=="complete"){var l=setTimeout(function(){o||(t(),o=!0)},n);e.addEventListener("load",function(){clearTimeout(l),o=!0,t()});return}var a="about:blank";if(r.location.href!==a||e.src===a||e.src===""){setTimeout(t,0);return}e.addEventListener("load",t)}}function ar(e){return e.getAttribute("href")?e.sheet!==null:!0}function lr(e,t,n){var r=!1,o;try{o=e.sheet}catch{return}if(!o){var i=setTimeout(function(){r||(t(),r=!0)},n);e.addEventListener("load",function(){clearTimeout(i),r=!0,t()})}}function cr(e,t){var n=t.doc,r=t.mirror,o=t.blockClass,i=t.blockSelector,l=t.maskTextClass,a=t.maskTextSelector,c=t.inlineStylesheet,s=t.maskInputOptions,u=s===void 0?{}:s,d=t.maskTextFn,m=t.maskInputFn,h=t.dataURLOptions,f=h===void 0?{}:h,g=t.inlineImages,S=t.recordCanvas,p=t.keepIframeSrcFn,b=t.newlyAddedElement,v=b===void 0?!1:b,C=ur(n,r);switch(e.nodeType){case e.DOCUMENT_NODE:return e.compatMode!=="CSS1Compat"?{type:M.Document,childNodes:[],compatMode:e.compatMode,rootId:C}:{type:M.Document,childNodes:[],rootId:C};case e.DOCUMENT_TYPE_NODE:return{type:M.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:C};case e.ELEMENT_NODE:return hr(e,{doc:n,blockClass:o,blockSelector:i,inlineStylesheet:c,maskInputOptions:u,maskInputFn:m,dataURLOptions:f,inlineImages:g,recordCanvas:S,keepIframeSrcFn:p,newlyAddedElement:v,rootId:C});case e.TEXT_NODE:return dr(e,{maskTextClass:l,maskTextSelector:a,maskTextFn:d,rootId:C});case e.CDATA_SECTION_NODE:return{type:M.CDATA,textContent:"",rootId:C};case e.COMMENT_NODE:return{type:M.Comment,textContent:e.textContent||"",rootId:C};default:return!1}}function ur(e,t){if(t.hasNode(e)){var n=t.getId(e);return n===1?void 0:n}}function dr(e,t){var n,r=t.maskTextClass,o=t.maskTextSelector,i=t.maskTextFn,l=t.rootId,a=e.parentNode&&e.parentNode.tagName,c=e.textContent,s=a==="STYLE"?!0:void 0,u=a==="SCRIPT"?!0:void 0;if(s&&c){try{e.nextSibling||e.previousSibling||!((n=e.parentNode.sheet)===null||n===void 0)&&n.cssRules&&(c=Kn(e.parentNode.sheet))}catch(d){console.warn("Cannot get CSS styles from text's parentNode. Error: ".concat(d),e)}c=$e(c,Qe())}return u&&(c="SCRIPT_PLACEHOLDER"),!s&&!u&&c&&Ct(e,r,o)&&(c=i?i(c):c.replace(/[\S]/g,"*")),{type:M.Text,textContent:c||"",isStyle:s,rootId:l}}function hr(e,t){for(var n=t.doc,r=t.blockClass,o=t.blockSelector,i=t.inlineStylesheet,l=t.maskInputOptions,a=l===void 0?{}:l,c=t.maskInputFn,s=t.dataURLOptions,u=s===void 0?{}:s,d=t.inlineImages,m=t.recordCanvas,h=t.keepIframeSrcFn,f=t.newlyAddedElement,g=f===void 0?!1:f,S=t.rootId,p=sr(e,r,o),b=Hn(e),v={},C=e.attributes.length,A=0;A<C;A++){var k=e.attributes[A];v[k.name]=Et(n,b,k.name,k.value)}if(b==="link"&&i){var F=Array.from(n.styleSheets).find(function(w){return w.href===e.href}),_=null;F&&(_=Ke(F)),_&&(delete v.rel,delete v.href,v._cssText=$e(_,F.href))}if(b==="style"&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){var _=Ke(e.sheet);_&&(v._cssText=$e(_,Qe()))}if(b==="input"||b==="textarea"||b==="select"){var J=e.value;v.type!=="radio"&&v.type!=="checkbox"&&v.type!=="submit"&&v.type!=="button"&&J?v.value=Ze({type:v.type,tagName:b,value:J,maskInputOptions:a,maskInputFn:c}):e.checked&&(v.checked=e.checked)}if(b==="option"&&(e.selected&&!a.select?v.selected=!0:delete v.selected),b==="canvas"&&m){if(e.__context==="2d")jn(e)||(v.rr_dataURL=e.toDataURL(u.type,u.quality));else if(!("__context"in e)){var H=e.toDataURL(u.type,u.quality),B=document.createElement("canvas");B.width=e.width,B.height=e.height;var Z=B.toDataURL(u.type,u.quality);H!==Z&&(v.rr_dataURL=H)}}if(b==="img"&&d){ge||(ge=n.createElement("canvas"),Tt=ge.getContext("2d"));var W=e,K=W.crossOrigin;W.crossOrigin="anonymous";var Q=function(){try{ge.width=W.naturalWidth,ge.height=W.naturalHeight,Tt.drawImage(W,0,0),v.rr_dataURL=ge.toDataURL(u.type,u.quality)}catch(w){console.warn("Cannot inline img src=".concat(W.currentSrc,"! Error: ").concat(w))}K?v.crossOrigin=K:W.removeAttribute("crossorigin")};W.complete&&W.naturalWidth!==0?Q():W.onload=Q}if((b==="audio"||b==="video")&&(v.rr_mediaState=e.paused?"paused":"played",v.rr_mediaCurrentTime=e.currentTime),g||(e.scrollLeft&&(v.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(v.rr_scrollTop=e.scrollTop)),p){var z=e.getBoundingClientRect(),R=z.width,X=z.height;v={class:v.class,rr_width:"".concat(R,"px"),rr_height:"".concat(X,"px")}}return b==="iframe"&&!h(v.src)&&(e.contentDocument||(v.rr_src=v.src),delete v.src),{type:M.Element,tagName:b,attributes:v,childNodes:[],isSVG:or(e)||void 0,needBlock:p,rootId:S}}function L(e){return e===void 0?"":e.toLowerCase()}function mr(e,t){return!!(t.comment&&e.type===M.Comment||e.type===M.Element&&(t.script&&(e.tagName==="script"||e.tagName==="link"&&e.attributes.rel==="preload"&&e.attributes.as==="script"||e.tagName==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&e.attributes.href.endsWith(".js"))||t.headFavicon&&(e.tagName==="link"&&e.attributes.rel==="shortcut icon"||e.tagName==="meta"&&(L(e.attributes.name).match(/^msapplication-tile(image|color)$/)||L(e.attributes.name)==="application-name"||L(e.attributes.rel)==="icon"||L(e.attributes.rel)==="apple-touch-icon"||L(e.attributes.rel)==="shortcut icon"))||e.tagName==="meta"&&(t.headMetaDescKeywords&&L(e.attributes.name).match(/^description|keywords$/)||t.headMetaSocial&&(L(e.attributes.property).match(/^(og|twitter|fb):/)||L(e.attributes.name).match(/^(og|twitter):/)||L(e.attributes.name)==="pinterest")||t.headMetaRobots&&(L(e.attributes.name)==="robots"||L(e.attributes.name)==="googlebot"||L(e.attributes.name)==="bingbot")||t.headMetaHttpEquiv&&e.attributes["http-equiv"]!==void 0||t.headMetaAuthorship&&(L(e.attributes.name)==="author"||L(e.attributes.name)==="generator"||L(e.attributes.name)==="framework"||L(e.attributes.name)==="publisher"||L(e.attributes.name)==="progid"||L(e.attributes.property).match(/^article:/)||L(e.attributes.property).match(/^product:/))||t.headMetaVerification&&(L(e.attributes.name)==="google-site-verification"||L(e.attributes.name)==="yandex-verification"||L(e.attributes.name)==="csrf-token"||L(e.attributes.name)==="p:domain_verify"||L(e.attributes.name)==="verify-v1"||L(e.attributes.name)==="verification"||L(e.attributes.name)==="shopify-checkout-api-token"))))}function ye(e,t){var n=t.doc,r=t.mirror,o=t.blockClass,i=t.blockSelector,l=t.maskTextClass,a=t.maskTextSelector,c=t.skipChild,s=c===void 0?!1:c,u=t.inlineStylesheet,d=u===void 0?!0:u,m=t.maskInputOptions,h=m===void 0?{}:m,f=t.maskTextFn,g=t.maskInputFn,S=t.slimDOMOptions,p=t.dataURLOptions,b=p===void 0?{}:p,v=t.inlineImages,C=v===void 0?!1:v,A=t.recordCanvas,k=A===void 0?!1:A,F=t.onSerialize,_=t.onIframeLoad,J=t.iframeLoadTimeout,H=J===void 0?5e3:J,B=t.onStylesheetLoad,Z=t.stylesheetLoadTimeout,W=Z===void 0?5e3:Z,K=t.keepIframeSrcFn,Q=K===void 0?function(){return!1}:K,z=t.newlyAddedElement,R=z===void 0?!1:z,X=t.preserveWhiteSpace,w=X===void 0?!0:X,y=cr(e,{doc:n,mirror:r,blockClass:o,blockSelector:i,maskTextClass:l,maskTextSelector:a,inlineStylesheet:d,maskInputOptions:h,maskTextFn:f,maskInputFn:g,dataURLOptions:b,inlineImages:C,recordCanvas:k,keepIframeSrcFn:Q,newlyAddedElement:R});if(!y)return console.warn(e,"not serialized"),null;var N;if(r.hasNode(e)?N=r.getId(e):mr(y,S)||!w&&y.type===M.Text&&!y.isStyle&&!y.textContent.replace(/^\s+|\s+$/gm,"").length?N=ke:N=Yn(),N===ke)return null;var T=Object.assign(y,{id:N});r.add(e,T),F&&F(e);var P=!s;if(T.type===M.Element){P=P&&!T.needBlock,delete T.needBlock;var U=e.shadowRoot;U&&Re(U)&&(T.isShadowHost=!0)}if((T.type===M.Document||T.type===M.Element)&&P){S.headWhitespace&&T.type===M.Element&&T.tagName==="head"&&(w=!1);for(var ae={doc:n,mirror:r,blockClass:o,blockSelector:i,maskTextClass:l,maskTextSelector:a,skipChild:s,inlineStylesheet:d,maskInputOptions:h,maskTextFn:f,maskInputFn:g,slimDOMOptions:S,dataURLOptions:b,inlineImages:C,recordCanvas:k,preserveWhiteSpace:w,onSerialize:F,onIframeLoad:_,iframeLoadTimeout:H,onStylesheetLoad:B,stylesheetLoadTimeout:W,keepIframeSrcFn:Q},O=0,V=Array.from(e.childNodes);O<V.length;O++){var fe=V[O],Me=ye(fe,ae);Me&&T.childNodes.push(Me)}if(St(e)&&e.shadowRoot)for(var bt=0,Vn=Array.from(e.shadowRoot.childNodes);bt<Vn.length;bt++){var fe=Vn[bt],Me=ye(fe,ae);Me&&(Re(e.shadowRoot)&&(Me.isShadow=!0),T.childNodes.push(Me))}}return e.parentNode&&De(e.parentNode)&&Re(e.parentNode)&&(T.isShadow=!0),T.type===M.Element&&T.tagName==="iframe"&&ir(e,function(){var xe=e.contentDocument;if(xe&&_){var Un=ye(xe,{doc:xe,mirror:r,blockClass:o,blockSelector:i,maskTextClass:l,maskTextSelector:a,skipChild:!1,inlineStylesheet:d,maskInputOptions:h,maskTextFn:f,maskInputFn:g,slimDOMOptions:S,dataURLOptions:b,inlineImages:C,recordCanvas:k,preserveWhiteSpace:w,onSerialize:F,onIframeLoad:_,iframeLoadTimeout:H,onStylesheetLoad:B,stylesheetLoadTimeout:W,keepIframeSrcFn:Q});Un&&_(e,Un)}},H),T.type===M.Element&&T.tagName==="link"&&T.attributes.rel==="stylesheet"&&(lr(e,function(){if(B){var xe=ye(e,{doc:n,mirror:r,blockClass:o,blockSelector:i,maskTextClass:l,maskTextSelector:a,skipChild:!1,inlineStylesheet:d,maskInputOptions:h,maskTextFn:f,maskInputFn:g,slimDOMOptions:S,dataURLOptions:b,inlineImages:C,recordCanvas:k,preserveWhiteSpace:w,onSerialize:F,onIframeLoad:_,iframeLoadTimeout:H,onStylesheetLoad:B,stylesheetLoadTimeout:W,keepIframeSrcFn:Q});xe&&B(e,xe)}},W),ar(e)===!1)?null:T}function pr(e,t){var n=t||{},r=n.mirror,o=r===void 0?new Xe:r,i=n.blockClass,l=i===void 0?"rr-block":i,a=n.blockSelector,c=a===void 0?null:a,s=n.maskTextClass,u=s===void 0?"rr-mask":s,d=n.maskTextSelector,m=d===void 0?null:d,h=n.inlineStylesheet,f=h===void 0?!0:h,g=n.inlineImages,S=g===void 0?!1:g,p=n.recordCanvas,b=p===void 0?!1:p,v=n.maskAllInputs,C=v===void 0?!1:v,A=n.maskTextFn,k=n.maskInputFn,F=n.slimDOM,_=F===void 0?!1:F,J=n.dataURLOptions,H=n.preserveWhiteSpace,B=n.onSerialize,Z=n.onIframeLoad,W=n.iframeLoadTimeout,K=n.onStylesheetLoad,Q=n.stylesheetLoadTimeout,z=n.keepIframeSrcFn,R=z===void 0?function(){return!1}:z,X=C===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:C===!1?{password:!0}:C,w=_===!0||_==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:_==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:_===!1?{}:_;return ye(e,{doc:e,mirror:o,blockClass:l,blockSelector:c,maskTextClass:u,maskTextSelector:m,skipChild:!1,inlineStylesheet:f,maskInputOptions:X,maskTextFn:A,maskInputFn:k,slimDOMOptions:w,dataURLOptions:J,inlineImages:S,recordCanvas:b,preserveWhiteSpace:H,onSerialize:B,onIframeLoad:Z,iframeLoadTimeout:W,onStylesheetLoad:K,stylesheetLoadTimeout:Q,keepIframeSrcFn:R,newlyAddedElement:!1})}var It=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function fr(e,t){t===void 0&&(t={});var n=1,r=1;function o(w){var y=w.match(/\n/g);y&&(n+=y.length);var N=w.lastIndexOf(`
`);r=N===-1?r+w.length:w.length-N}function i(){var w={line:n,column:r};return function(y){return y.position=new l(w),f(),y}}var l=function(){function w(y){this.start=y,this.end={line:n,column:r},this.source=t.source}return w}();l.prototype.content=e;var a=[];function c(w){var y=new Error("".concat(t.source||"",":").concat(n,":").concat(r,": ").concat(w));if(y.reason=w,y.filename=t.source,y.line=n,y.column=r,y.source=e,t.silent)a.push(y);else throw y}function s(){var w=m();return{type:"stylesheet",stylesheet:{source:t.source,rules:w,parsingErrors:a}}}function u(){return h(/^{\s*/)}function d(){return h(/^}/)}function m(){var w,y=[];for(f(),g(y);e.length&&e.charAt(0)!=="}"&&(w=R()||X());)w!==!1&&(y.push(w),g(y));return y}function h(w){var y=w.exec(e);if(y){var N=y[0];return o(N),e=e.slice(N.length),y}}function f(){h(/^\s*/)}function g(w){w===void 0&&(w=[]);for(var y;y=S();)y!==!1&&w.push(y),y=S();return w}function S(){var w=i();if(!(e.charAt(0)!=="/"||e.charAt(1)!=="*")){for(var y=2;e.charAt(y)!==""&&(e.charAt(y)!=="*"||e.charAt(y+1)!=="/");)++y;if(y+=2,e.charAt(y-1)==="")return c("End of comment missing");var N=e.slice(2,y-2);return r+=2,o(N),e=e.slice(y),r+=2,w({type:"comment",comment:N})}}function p(){var w=h(/^([^{]+)/);if(w)return le(w[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(y){return y.replace(/,/g,"\u200C")}).split(/\s*(?![^(]*\)),\s*/).map(function(y){return y.replace(/\u200C/g,",")})}function b(){var w=i(),y=h(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(y){var N=le(y[0]);if(!h(/^:\s*/))return c("property missing ':'");var T=h(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),P=w({type:"declaration",property:N.replace(It,""),value:T?le(T[0]).replace(It,""):""});return h(/^[;\s]*/),P}}function v(){var w=[];if(!u())return c("missing '{'");g(w);for(var y;y=b();)y!==!1&&(w.push(y),g(w)),y=b();return d()?w:c("missing '}'")}function C(){for(var w,y=[],N=i();w=h(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)y.push(w[1]),h(/^,\s*/);if(y.length)return N({type:"keyframe",values:y,declarations:v()})}function A(){var w=i(),y=h(/^@([-\w]+)?keyframes\s*/);if(y){var N=y[1];if(y=h(/^([-\w]+)\s*/),!y)return c("@keyframes missing name");var T=y[1];if(!u())return c("@keyframes missing '{'");for(var P,U=g();P=C();)U.push(P),U=U.concat(g());return d()?w({type:"keyframes",name:T,vendor:N,keyframes:U}):c("@keyframes missing '}'")}}function k(){var w=i(),y=h(/^@supports *([^{]+)/);if(y){var N=le(y[1]);if(!u())return c("@supports missing '{'");var T=g().concat(m());return d()?w({type:"supports",supports:N,rules:T}):c("@supports missing '}'")}}function F(){var w=i(),y=h(/^@host\s*/);if(y){if(!u())return c("@host missing '{'");var N=g().concat(m());return d()?w({type:"host",rules:N}):c("@host missing '}'")}}function _(){var w=i(),y=h(/^@media *([^{]+)/);if(y){var N=le(y[1]);if(!u())return c("@media missing '{'");var T=g().concat(m());return d()?w({type:"media",media:N,rules:T}):c("@media missing '}'")}}function J(){var w=i(),y=h(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(y)return w({type:"custom-media",name:le(y[1]),media:le(y[2])})}function H(){var w=i(),y=h(/^@page */);if(y){var N=p()||[];if(!u())return c("@page missing '{'");for(var T=g(),P;P=b();)T.push(P),T=T.concat(g());return d()?w({type:"page",selectors:N,declarations:T}):c("@page missing '}'")}}function B(){var w=i(),y=h(/^@([-\w]+)?document *([^{]+)/);if(y){var N=le(y[1]),T=le(y[2]);if(!u())return c("@document missing '{'");var P=g().concat(m());return d()?w({type:"document",document:T,vendor:N,rules:P}):c("@document missing '}'")}}function Z(){var w=i(),y=h(/^@font-face\s*/);if(y){if(!u())return c("@font-face missing '{'");for(var N=g(),T;T=b();)N.push(T),N=N.concat(g());return d()?w({type:"font-face",declarations:N}):c("@font-face missing '}'")}}var W=z("import"),K=z("charset"),Q=z("namespace");function z(w){var y=new RegExp("^@"+w+"\\s*([^;]+);");return function(){var N=i(),T=h(y);if(T){var P={type:w};return P[w]=T[1].trim(),N(P)}}}function R(){if(e[0]==="@")return A()||_()||J()||k()||W()||K()||Q()||B()||H()||F()||Z()}function X(){var w=i(),y=p();return y?(g(),w({type:"rule",selectors:y,declarations:v()})):c("selector missing")}return qe(s())}function le(e){return e?e.replace(/^\s+|\s+$/g,""):""}function qe(e,t){for(var n=e&&typeof e.type=="string",r=n?e:t,o=0,i=Object.keys(e);o<i.length;o++){var l=i[o],a=e[l];Array.isArray(a)?a.forEach(function(c){qe(c,r)}):a&&typeof a=="object"&&qe(a,r)}return n&&Object.defineProperty(e,"parent",{configurable:!0,writable:!0,enumerable:!1,value:t||null}),e}var Mt={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function gr(e){var t=Mt[e.tagName]?Mt[e.tagName]:e.tagName;return t==="link"&&e.attributes._cssText&&(t="style"),t}function yr(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var xt=/([^\\]):hover/,vr=new RegExp(xt.source,"g");function Dt(e,t){var n=t?.stylesWithHoverClass.get(e);if(n)return n;var r=fr(e,{silent:!0});if(!r.stylesheet)return e;var o=[];if(r.stylesheet.rules.forEach(function(a){"selectors"in a&&(a.selectors||[]).forEach(function(c){xt.test(c)&&o.push(c)})}),o.length===0)return e;var i=new RegExp(o.filter(function(a,c){return o.indexOf(a)===c}).sort(function(a,c){return c.length-a.length}).map(function(a){return yr(a)}).join("|"),"g"),l=e.replace(i,function(a){var c=a.replace(vr,"$1.\\:hover");return"".concat(a,", ").concat(c)});return t?.stylesWithHoverClass.set(e,l),l}function Rt(){var e=new Map;return{stylesWithHoverClass:e}}function br(e,t){var n=t.doc,r=t.hackCss,o=t.cache;switch(e.type){case M.Document:return n.implementation.createDocument(null,"",null);case M.DocumentType:return n.implementation.createDocumentType(e.name||"html",e.publicId,e.systemId);case M.Element:{var i=gr(e),l;e.isSVG?l=n.createElementNS("http://www.w3.org/2000/svg",i):l=n.createElement(i);var a=function(s){if(!Object.prototype.hasOwnProperty.call(e.attributes,s))return"continue";var u=e.attributes[s];if(i==="option"&&s==="selected"&&u===!1)return"continue";if(u=typeof u=="boolean"||typeof u=="number"?"":u,s.startsWith("rr_")){if(i==="canvas"&&s==="rr_dataURL"){var d=document.createElement("img");d.onload=function(){var v=l.getContext("2d");v&&v.drawImage(d,0,0,d.width,d.height)},d.src=u,l.RRNodeType&&(l.rr_dataURL=u)}else if(i==="img"&&s==="rr_dataURL"){var m=l;m.currentSrc.startsWith("data:")||(m.setAttribute("rrweb-original-src",e.attributes.src),m.src=u)}if(s==="rr_width")l.style.width=u;else if(s==="rr_height")l.style.height=u;else if(s==="rr_mediaCurrentTime")l.currentTime=e.attributes.rr_mediaCurrentTime;else if(s==="rr_mediaState")switch(u){case"played":l.play().catch(function(v){return console.warn("media playback error",v)});break;case"paused":l.pause();break}}else{var h=i==="textarea"&&s==="value",f=i==="style"&&s==="_cssText";if(f&&r&&(u=Dt(u,o)),h||f){for(var g=n.createTextNode(u),S=0,p=Array.from(l.childNodes);S<p.length;S++){var b=p[S];b.nodeType===l.TEXT_NODE&&l.removeChild(b)}return l.appendChild(g),"continue"}try{if(e.isSVG&&s==="xlink:href")l.setAttributeNS("http://www.w3.org/1999/xlink",s,u);else if(s==="onload"||s==="onclick"||s.substring(0,7)==="onmouse")l.setAttribute("_"+s,u);else{if(i==="meta"&&e.attributes["http-equiv"]==="Content-Security-Policy"&&s==="content")return l.setAttribute("csp-content",u),"continue";i==="link"&&e.attributes.rel==="preload"&&e.attributes.as==="script"||i==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&e.attributes.href.endsWith(".js")||(i==="img"&&e.attributes.srcset&&e.attributes.rr_dataURL?l.setAttribute("rrweb-original-srcset",e.attributes.srcset):l.setAttribute(s,u))}}catch{}}};for(var c in e.attributes)a(c);if(e.isShadowHost)if(!l.shadowRoot)l.attachShadow({mode:"open"});else for(;l.shadowRoot.firstChild;)l.shadowRoot.removeChild(l.shadowRoot.firstChild);return l}case M.Text:return n.createTextNode(e.isStyle&&r?Dt(e.textContent,o):e.textContent);case M.CDATA:return n.createCDATASection(e.textContent);case M.Comment:return n.createComment(e.textContent);default:return null}}function Ge(e,t){var n=t.doc,r=t.mirror,o=t.skipChild,i=o===void 0?!1:o,l=t.hackCss,a=l===void 0?!0:l,c=t.afterAppend,s=t.cache,u=br(e,{doc:n,hackCss:a,cache:s});if(!u)return null;if(e.rootId&&console.assert(r.getNode(e.rootId)===n,"Target document should have the same root id."),e.type===M.Document&&(n.close(),n.open(),e.compatMode==="BackCompat"&&e.childNodes&&e.childNodes[0].type!==M.DocumentType&&(e.childNodes[0].type===M.Element&&"xmlns"in e.childNodes[0].attributes&&e.childNodes[0].attributes.xmlns==="http://www.w3.org/1999/xhtml"?n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),u=n),r.add(u,e),(e.type===M.Document||e.type===M.Element)&&!i)for(var d=0,m=e.childNodes;d<m.length;d++){var h=m[d],f=Ge(h,{doc:n,mirror:r,skipChild:!1,hackCss:a,afterAppend:c,cache:s});if(!f){console.warn("Failed to rebuild",h);continue}h.isShadow&&St(u)&&u.shadowRoot?u.shadowRoot.appendChild(f):u.appendChild(f),c&&c(f)}return u}function Sr(e,t){function n(l){t(l)}for(var r=0,o=e.getIds();r<o.length;r++){var i=o[r];e.has(i)&&n(e.getNode(i))}}function wr(e,t){var n=t.getMeta(e);if(n?.type===M.Element){var r=e;for(var o in n.attributes)if(Object.prototype.hasOwnProperty.call(n.attributes,o)&&o.startsWith("rr_")){var i=n.attributes[o];o==="rr_scrollLeft"&&(r.scrollLeft=i),o==="rr_scrollTop"&&(r.scrollTop=i)}}}function Nr(e,t){var n=t.doc,r=t.onVisit,o=t.hackCss,i=o===void 0?!0:o,l=t.afterAppend,a=t.cache,c=t.mirror,s=c===void 0?new Xe:c,u=Ge(e,{doc:n,mirror:s,skipChild:!1,hackCss:i,afterAppend:l,cache:a});return Sr(s,function(d){r&&r(d),wr(d,s)}),u}function ee(e,t,n=document){const r={capture:!0,passive:!0};return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}const ve=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;q.mirror={map:{},getId(){return console.error(ve),-1},getNode(){return console.error(ve),null},removeNodeFromMap(){console.error(ve)},has(){return console.error(ve),!1},reset(){console.error(ve)}},typeof window<"u"&&window.Proxy&&window.Reflect&&(q.mirror=new Proxy(q.mirror,{get(e,t,n){return t==="map"&&console.error(ve),Reflect.get(e,t,n)}}));function be(e,t,n={}){let r=null,o=0;return function(...i){const l=Date.now();!o&&n.leading===!1&&(o=l);const a=t-(l-o),c=this;a<=0||a>t?(r&&(clearTimeout(r),r=null),o=l,e.apply(c,i)):!r&&n.trailing!==!1&&(r=setTimeout(()=>{o=n.leading===!1?0:Date.now(),r=null,e.apply(c,i)},a))}}function Oe(e,t,n,r,o=window){const i=o.Object.getOwnPropertyDescriptor(e,t);return o.Object.defineProperty(e,t,r?n:{set(l){setTimeout(()=>{n.set.call(this,l)},0),i&&i.set&&i.set.call(this,l)}}),()=>Oe(e,t,i||{},!0)}function de(e,t,n){try{if(!(t in e))return()=>{};const r=e[t],o=n(r);return typeof o=="function"&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=o,()=>{e[t]=r}}catch{return()=>{}}}function Je(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function et(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function te(e,t,n){if(!e)return!1;const r=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(!r)return!1;if(typeof t=="string"){if(r.classList.contains(t)||n&&r.closest("."+t)!==null)return!0}else if(Ue(r,t,n))return!0;return!1}function kt(e,t){return t.getId(e)!==-1}function je(e,t){return t.getId(e)===ke}function tt(e,t){if(De(e))return!1;const n=t.getId(e);return t.has(n)?e.parentNode&&e.parentNode.nodeType===e.DOCUMENT_NODE?!1:e.parentNode?tt(e.parentNode,t):!0:!0}function nt(e){return Boolean(e.changedTouches)}function rt(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...t)=>{let n=t[0];if(!(0 in t))throw new TypeError("1 argument is required");do if(this===n)return!0;while(n=n&&n.parentNode);return!1})}function Ot(e){const t={},n=(o,i)=>{const l={value:o,parent:i,children:[]};return t[o.node.id]=l,l},r=[];for(const o of e){const{nextId:i,parentId:l}=o;if(i&&i in t){const a=t[i];if(a.parent){const c=a.parent.children.indexOf(a);a.parent.children.splice(c,0,n(o,a.parent))}else{const c=r.indexOf(a);r.splice(c,0,n(o,null))}continue}if(l in t){const a=t[l];a.children.push(n(o,a));continue}r.push(n(o,null))}return r}function ot(e,t){t(e.value);for(let n=e.children.length-1;n>=0;n--)ot(e.children[n],t)}function Se(e,t){return Boolean(e.nodeName==="IFRAME"&&t.getMeta(e))}function st(e,t){return Boolean(e.nodeName==="LINK"&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&e.getAttribute("rel")==="stylesheet"&&t.getMeta(e))}function it(e,t){var n,r;const o=(r=(n=e.ownerDocument)==null?void 0:n.defaultView)==null?void 0:r.frameElement;if(!o||o===t)return{x:0,y:0,relativeScale:1,absoluteScale:1};const i=o.getBoundingClientRect(),l=it(o,t),a=i.height/o.clientHeight;return{x:i.x*l.relativeScale+l.x,y:i.y*l.relativeScale+l.y,relativeScale:a,absoluteScale:l.absoluteScale*a}}function Ae(e){return Boolean(e?.shadowRoot)}function we(e,t){const n=e[t[0]];return t.length===1?n:we(n.cssRules[t[1]].cssRules,t.slice(2))}function at(e){const t=[...e],n=t.pop();return{positions:t,index:n}}function At(e){const t=new Set,n=[];for(let r=e.length;r--;){const o=e[r];t.has(o.id)||(n.push(o),t.add(o.id))}return n}var Tr=Object.freeze({__proto__:null,on:ee,get _mirror(){return q.mirror},throttle:be,hookSetter:Oe,patch:de,getWindowHeight:Je,getWindowWidth:et,isBlocked:te,isSerialized:kt,isIgnored:je,isAncestorRemoved:tt,isTouchEvent:nt,polyfill:rt,queueToResolveTrees:Ot,iterateResolveTree:ot,isSerializedIframe:Se,isSerializedStylesheet:st,getBaseDimension:it,hasShadowRoot:Ae,getNestedRule:we,getPositionsAndIndex:at,uniqueTextMutations:At}),E=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(E||{}),I=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e))(I||{}),j=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(j||{}),ce=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(ce||{}),he=(e=>(e[e.Play=0]="Play",e[e.Pause=1]="Pause",e[e.Seeked=2]="Seeked",e[e.VolumeChange=3]="VolumeChange",e))(he||{}),D=(e=>(e.Start="start",e.Pause="pause",e.Resume="resume",e.Resize="resize",e.Finish="finish",e.FullsnapshotRebuilded="fullsnapshot-rebuilded",e.LoadStylesheetStart="load-stylesheet-start",e.LoadStylesheetEnd="load-stylesheet-end",e.SkipStart="skip-start",e.SkipEnd="skip-end",e.MouseInteraction="mouse-interaction",e.EventCast="event-cast",e.CustomEvent="custom-event",e.Flush="flush",e.StateChange="state-change",e.PlayBack="play-back",e))(D||{});function Lt(e){return"__ln"in e}class Er{constructor(){this.length=0,this.head=null}get(t){if(t>=this.length)throw new Error("Position outside of list range");let n=this.head;for(let r=0;r<t;r++)n=n?.next||null;return n}addNode(t){const n={value:t,previous:null,next:null};if(t.__ln=n,t.previousSibling&&Lt(t.previousSibling)){const r=t.previousSibling.__ln.next;n.next=r,n.previous=t.previousSibling.__ln,t.previousSibling.__ln.next=n,r&&(r.previous=n)}else if(t.nextSibling&&Lt(t.nextSibling)&&t.nextSibling.__ln.previous){const r=t.nextSibling.__ln.previous;n.previous=r,n.next=t.nextSibling.__ln,t.nextSibling.__ln.previous=n,r&&(r.next=n)}else this.head&&(this.head.previous=n),n.next=this.head,this.head=n;this.length++}removeNode(t){const n=t.__ln;!this.head||(n.previous?(n.previous.next=n.next,n.next&&(n.next.previous=n.previous)):(this.head=n.next,this.head&&(this.head.previous=null)),t.__ln&&delete t.__ln,this.length--)}}const _t=(e,t)=>`${e}@${t}`;class Cr{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=t=>{t.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const t=[],n=new Er,r=a=>{let c=a,s=ke;for(;s===ke;)c=c&&c.nextSibling,s=c&&this.mirror.getId(c);return s},o=a=>{var c,s,u,d,m;const h=a.getRootNode?(c=a.getRootNode())==null?void 0:c.host:null;let f=h;for(;(u=(s=f?.getRootNode)==null?void 0:s.call(f))!=null&&u.host;)f=((m=(d=f?.getRootNode)==null?void 0:d.call(f))==null?void 0:m.host)||null;const g=!this.doc.contains(a)&&(!f||!this.doc.contains(f));if(!a.parentNode||g)return;const S=De(a.parentNode)?this.mirror.getId(h):this.mirror.getId(a.parentNode),p=r(a);if(S===-1||p===-1)return n.addNode(a);const b=ye(a,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:v=>{Se(v,this.mirror)&&this.iframeManager.addIframe(v),st(v,this.mirror)&&this.stylesheetManager.addStylesheet(v),Ae(a)&&this.shadowDomManager.addShadowRoot(a.shadowRoot,document)},onIframeLoad:(v,C)=>{this.iframeManager.attachIframe(v,C,this.mirror),this.shadowDomManager.observeAttachShadow(v)},onStylesheetLoad:(v,C)=>{this.stylesheetManager.attachStylesheet(v,C,this.mirror)}});b&&t.push({parentId:S,nextId:p,node:b})};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const a of Array.from(this.movedSet.values()))Ft(this.removes,a,this.mirror)&&!this.movedSet.has(a.parentNode)||o(a);for(const a of Array.from(this.addedSet.values()))!Wt(this.droppedSet,a)&&!Ft(this.removes,a,this.mirror)||Wt(this.movedSet,a)?o(a):this.droppedSet.add(a);let i=null;for(;n.length;){let a=null;if(i){const c=this.mirror.getId(i.value.parentNode),s=r(i.value);c!==-1&&s!==-1&&(a=i)}if(!a)for(let c=n.length-1;c>=0;c--){const s=n.get(c);if(s){const u=this.mirror.getId(s.value.parentNode),d=r(s.value);if(u!==-1&&d!==-1){a=s;break}}}if(!a){for(;n.head;)n.removeNode(n.head.value);break}i=a.previous,n.removeNode(a.value),o(a.value)}const l={texts:this.texts.map(a=>({id:this.mirror.getId(a.node),value:a.value})).filter(a=>this.mirror.has(a.id)),attributes:this.attributes.map(a=>({id:this.mirror.getId(a.node),attributes:a.attributes})).filter(a=>this.mirror.has(a.id)),removes:this.removes,adds:t};!l.texts.length&&!l.attributes.length&&!l.removes.length&&!l.adds.length||(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(l))},this.processMutation=t=>{if(!je(t.target,this.mirror))switch(t.type){case"characterData":{const n=t.target.textContent;!te(t.target,this.blockClass,!1)&&n!==t.oldValue&&this.texts.push({value:Ct(t.target,this.maskTextClass,this.maskTextSelector)&&n?this.maskTextFn?this.maskTextFn(n):n.replace(/[\S]/g,"*"):n,node:t.target});break}case"attributes":{const n=t.target;let r=t.target.getAttribute(t.attributeName);if(t.attributeName==="value"&&(r=Ze({maskInputOptions:this.maskInputOptions,tagName:t.target.tagName,type:t.target.getAttribute("type"),value:r,maskInputFn:this.maskInputFn})),te(t.target,this.blockClass,!1)||r===t.oldValue)return;let o=this.attributes.find(i=>i.node===t.target);if(o||(o={node:t.target,attributes:{}},this.attributes.push(o)),t.attributeName==="style"){const i=this.doc.createElement("span");t.oldValue&&i.setAttribute("style",t.oldValue),(o.attributes.style===void 0||o.attributes.style===null)&&(o.attributes.style={});const l=o.attributes.style;for(const a of Array.from(n.style)){const c=n.style.getPropertyValue(a),s=n.style.getPropertyPriority(a);(c!==i.style.getPropertyValue(a)||s!==i.style.getPropertyPriority(a))&&(s===""?l[a]=c:l[a]=[c,s])}for(const a of Array.from(i.style))n.style.getPropertyValue(a)===""&&(l[a]=!1)}else o.attributes[t.attributeName]=Et(this.doc,t.target.tagName,t.attributeName,r);break}case"childList":{if(te(t.target,this.blockClass,!0))return;t.addedNodes.forEach(n=>this.genAdds(n,t.target)),t.removedNodes.forEach(n=>{const r=this.mirror.getId(n),o=De(t.target)?this.mirror.getId(t.target.host):this.mirror.getId(t.target);te(t.target,this.blockClass,!1)||je(n,this.mirror)||!kt(n,this.mirror)||(this.addedSet.has(n)?(lt(this.addedSet,n),this.droppedSet.add(n)):this.addedSet.has(t.target)&&r===-1||tt(t.target,this.mirror)||(this.movedSet.has(n)&&this.movedMap[_t(r,o)]?lt(this.movedSet,n):this.removes.push({parentId:o,id:r,isShadow:De(t.target)&&Re(t.target)?!0:void 0})),this.mapRemoves.push(n))});break}}},this.genAdds=(t,n)=>{if(this.mirror.hasNode(t)){if(je(t,this.mirror))return;this.movedSet.add(t);let r=null;n&&this.mirror.hasNode(n)&&(r=this.mirror.getId(n)),r&&r!==-1&&(this.movedMap[_t(this.mirror.getId(t),r)]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);te(t,this.blockClass,!1)||t.childNodes.forEach(r=>this.genAdds(r))}}init(t){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","recordCanvas","inlineImages","slimDOMOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager"].forEach(n=>{this[n]=t[n]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function lt(e,t){e.delete(t),t.childNodes.forEach(n=>lt(e,n))}function Ft(e,t,n){return e.length===0?!1:Pt(e,t,n)}function Pt(e,t,n){const{parentNode:r}=t;if(!r)return!1;const o=n.getId(r);return e.some(i=>i.id===o)?!0:Pt(e,r,n)}function Wt(e,t){return e.size===0?!1:$t(e,t)}function $t(e,t){const{parentNode:n}=t;return n?e.has(n)?!0:$t(e,n):!1}var Ir=Object.defineProperty,Mr=Object.defineProperties,xr=Object.getOwnPropertyDescriptors,Vt=Object.getOwnPropertySymbols,Dr=Object.prototype.hasOwnProperty,Rr=Object.prototype.propertyIsEnumerable,Ut=(e,t,n)=>t in e?Ir(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Gt=(e,t)=>{for(var n in t||(t={}))Dr.call(t,n)&&Ut(e,n,t[n]);if(Vt)for(var n of Vt(t))Rr.call(t,n)&&Ut(e,n,t[n]);return e},kr=(e,t)=>Mr(e,xr(t));const me=[],jt=typeof CSSGroupingRule<"u",Bt=typeof CSSMediaRule<"u",zt=typeof CSSSupportsRule<"u",Yt=typeof CSSConditionRule<"u";function Le(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0];return e.target}catch{return e.target}}function Ht(e,t){var n,r;const o=new Cr;me.push(o),o.init(e);let i=window.MutationObserver||window.__rrMutationObserver;const l=(r=(n=window?.Zone)==null?void 0:n.__symbol__)==null?void 0:r.call(n,"MutationObserver");l&&window[l]&&(i=window[l]);const a=new i(o.processMutations.bind(o));return a.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),a}function Or({mousemoveCb:e,sampling:t,doc:n,mirror:r}){if(t.mousemove===!1)return()=>{};const o=typeof t.mousemove=="number"?t.mousemove:50,i=typeof t.mousemoveCallback=="number"?t.mousemoveCallback:500;let l=[],a;const c=be(d=>{const m=Date.now()-a;e(l.map(h=>(h.timeOffset-=m,h)),d),l=[],a=null},i),s=be(d=>{const m=Le(d),{clientX:h,clientY:f}=nt(d)?d.changedTouches[0]:d;a||(a=Date.now()),l.push({x:h,y:f,id:r.getId(m),timeOffset:Date.now()-a}),c(typeof DragEvent<"u"&&d instanceof DragEvent?I.Drag:d instanceof MouseEvent?I.MouseMove:I.TouchMove)},o,{trailing:!1}),u=[ee("mousemove",s,n),ee("touchmove",s,n),ee("drag",s,n)];return()=>{u.forEach(d=>d())}}function Ar({mouseInteractionCb:e,doc:t,mirror:n,blockClass:r,sampling:o}){if(o.mouseInteraction===!1)return()=>{};const i=o.mouseInteraction===!0||o.mouseInteraction===void 0?{}:o.mouseInteraction,l=[],a=c=>s=>{const u=Le(s);if(te(u,r,!0))return;const d=nt(s)?s.changedTouches[0]:s;if(!d)return;const m=n.getId(u),{clientX:h,clientY:f}=d;e({type:j[c],id:m,x:h,y:f})};return Object.keys(j).filter(c=>Number.isNaN(Number(c))&&!c.endsWith("_Departed")&&i[c]!==!1).forEach(c=>{const s=c.toLowerCase(),u=a(c);l.push(ee(s,u,t))}),()=>{l.forEach(c=>c())}}function Xt({scrollCb:e,doc:t,mirror:n,blockClass:r,sampling:o}){const i=be(l=>{const a=Le(l);if(!a||te(a,r,!0))return;const c=n.getId(a);if(a===t){const s=t.scrollingElement||t.documentElement;e({id:c,x:s.scrollLeft,y:s.scrollTop})}else e({id:c,x:a.scrollLeft,y:a.scrollTop})},o.scroll||100);return ee("scroll",i,t)}function Lr({viewportResizeCb:e}){let t=-1,n=-1;const r=be(()=>{const o=Je(),i=et();(t!==o||n!==i)&&(e({width:Number(i),height:Number(o)}),t=o,n=i)},200);return ee("resize",r,window)}function Zt(e,t){const n=Gt({},e);return t||delete n.userTriggered,n}const _r=["INPUT","TEXTAREA","SELECT"],Kt=new WeakMap;function Fr({inputCb:e,doc:t,mirror:n,blockClass:r,ignoreClass:o,maskInputOptions:i,maskInputFn:l,sampling:a,userTriggeredOnInput:c}){function s(f){let g=Le(f);const S=f.isTrusted;if(g&&g.tagName==="OPTION"&&(g=g.parentElement),!g||!g.tagName||_r.indexOf(g.tagName)<0||te(g,r,!0))return;const p=g.type;if(g.classList.contains(o))return;let b=g.value,v=!1;p==="radio"||p==="checkbox"?v=g.checked:(i[g.tagName.toLowerCase()]||i[p])&&(b=Ze({maskInputOptions:i,tagName:g.tagName,type:p,value:b,maskInputFn:l})),u(g,Zt({text:b,isChecked:v,userTriggered:S},c));const C=g.name;p==="radio"&&C&&v&&t.querySelectorAll(`input[type="radio"][name="${C}"]`).forEach(A=>{A!==g&&u(A,Zt({text:A.value,isChecked:!v,userTriggered:!1},c))})}function u(f,g){const S=Kt.get(f);if(!S||S.text!==g.text||S.isChecked!==g.isChecked){Kt.set(f,g);const p=n.getId(f);e(kr(Gt({},g),{id:p}))}}const d=(a.input==="last"?["change"]:["input","change"]).map(f=>ee(f,s,t)),m=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value"),h=[[HTMLInputElement.prototype,"value"],[HTMLInputElement.prototype,"checked"],[HTMLSelectElement.prototype,"value"],[HTMLTextAreaElement.prototype,"value"],[HTMLSelectElement.prototype,"selectedIndex"],[HTMLOptionElement.prototype,"selected"]];return m&&m.set&&d.push(...h.map(f=>Oe(f[0],f[1],{set(){s({target:this})}}))),()=>{d.forEach(f=>f())}}function Be(e){const t=[];function n(r,o){if(jt&&r.parentRule instanceof CSSGroupingRule||Bt&&r.parentRule instanceof CSSMediaRule||zt&&r.parentRule instanceof CSSSupportsRule||Yt&&r.parentRule instanceof CSSConditionRule){const i=Array.from(r.parentRule.cssRules).indexOf(r);o.unshift(i)}else{const i=Array.from(r.parentStyleSheet.cssRules).indexOf(r);o.unshift(i)}return o}return n(e,t)}function Pr({styleSheetRuleCb:e,mirror:t},{win:n}){const r=n.CSSStyleSheet.prototype.insertRule;n.CSSStyleSheet.prototype.insertRule=function(a,c){const s=t.getId(this.ownerNode);return s!==-1&&e({id:s,adds:[{rule:a,index:c}]}),r.apply(this,[a,c])};const o=n.CSSStyleSheet.prototype.deleteRule;n.CSSStyleSheet.prototype.deleteRule=function(a){const c=t.getId(this.ownerNode);return c!==-1&&e({id:c,removes:[{index:a}]}),o.apply(this,[a])};const i={};jt?i.CSSGroupingRule=n.CSSGroupingRule:(Bt&&(i.CSSMediaRule=n.CSSMediaRule),Yt&&(i.CSSConditionRule=n.CSSConditionRule),zt&&(i.CSSSupportsRule=n.CSSSupportsRule));const l={};return Object.entries(i).forEach(([a,c])=>{l[a]={insertRule:c.prototype.insertRule,deleteRule:c.prototype.deleteRule},c.prototype.insertRule=function(s,u){const d=t.getId(this.parentStyleSheet.ownerNode);return d!==-1&&e({id:d,adds:[{rule:s,index:[...Be(this),u||0]}]}),l[a].insertRule.apply(this,[s,u])},c.prototype.deleteRule=function(s){const u=t.getId(this.parentStyleSheet.ownerNode);return u!==-1&&e({id:u,removes:[{index:[...Be(this),s]}]}),l[a].deleteRule.apply(this,[s])}}),()=>{n.CSSStyleSheet.prototype.insertRule=r,n.CSSStyleSheet.prototype.deleteRule=o,Object.entries(i).forEach(([a,c])=>{c.prototype.insertRule=l[a].insertRule,c.prototype.deleteRule=l[a].deleteRule})}}function Wr({styleDeclarationCb:e,mirror:t},{win:n}){const r=n.CSSStyleDeclaration.prototype.setProperty;n.CSSStyleDeclaration.prototype.setProperty=function(i,l,a){var c,s;const u=t.getId((s=(c=this.parentRule)==null?void 0:c.parentStyleSheet)==null?void 0:s.ownerNode);return u!==-1&&e({id:u,set:{property:i,value:l,priority:a},index:Be(this.parentRule)}),r.apply(this,[i,l,a])};const o=n.CSSStyleDeclaration.prototype.removeProperty;return n.CSSStyleDeclaration.prototype.removeProperty=function(i){var l,a;const c=t.getId((a=(l=this.parentRule)==null?void 0:l.parentStyleSheet)==null?void 0:a.ownerNode);return c!==-1&&e({id:c,remove:{property:i},index:Be(this.parentRule)}),o.apply(this,[i])},()=>{n.CSSStyleDeclaration.prototype.setProperty=r,n.CSSStyleDeclaration.prototype.removeProperty=o}}function $r({mediaInteractionCb:e,blockClass:t,mirror:n,sampling:r}){const o=l=>be(a=>{const c=Le(a);if(!c||te(c,t,!0))return;const{currentTime:s,volume:u,muted:d}=c;e({type:l,id:n.getId(c),currentTime:s,volume:u,muted:d})},r.media||500),i=[ee("play",o(he.Play)),ee("pause",o(he.Pause)),ee("seeked",o(he.Seeked)),ee("volumechange",o(he.VolumeChange))];return()=>{i.forEach(l=>l())}}function Vr({fontCb:e,doc:t}){const n=t.defaultView;if(!n)return()=>{};const r=[],o=new WeakMap,i=n.FontFace;n.FontFace=function(a,c,s){const u=new i(a,c,s);return o.set(u,{family:a,buffer:typeof c!="string",descriptors:s,fontSource:typeof c=="string"?c:JSON.stringify(Array.from(new Uint8Array(c)))}),u};const l=de(t.fonts,"add",function(a){return function(c){return setTimeout(()=>{const s=o.get(c);s&&(e(s),o.delete(c))},0),a.apply(this,[c])}});return r.push(()=>{n.FontFace=i}),r.push(l),()=>{r.forEach(a=>a())}}function Ur(e,t){const{mutationCb:n,mousemoveCb:r,mouseInteractionCb:o,scrollCb:i,viewportResizeCb:l,inputCb:a,mediaInteractionCb:c,styleSheetRuleCb:s,styleDeclarationCb:u,canvasMutationCb:d,fontCb:m}=e;e.mutationCb=(...h)=>{t.mutation&&t.mutation(...h),n(...h)},e.mousemoveCb=(...h)=>{t.mousemove&&t.mousemove(...h),r(...h)},e.mouseInteractionCb=(...h)=>{t.mouseInteraction&&t.mouseInteraction(...h),o(...h)},e.scrollCb=(...h)=>{t.scroll&&t.scroll(...h),i(...h)},e.viewportResizeCb=(...h)=>{t.viewportResize&&t.viewportResize(...h),l(...h)},e.inputCb=(...h)=>{t.input&&t.input(...h),a(...h)},e.mediaInteractionCb=(...h)=>{t.mediaInteaction&&t.mediaInteaction(...h),c(...h)},e.styleSheetRuleCb=(...h)=>{t.styleSheetRule&&t.styleSheetRule(...h),s(...h)},e.styleDeclarationCb=(...h)=>{t.styleDeclaration&&t.styleDeclaration(...h),u(...h)},e.canvasMutationCb=(...h)=>{t.canvasMutation&&t.canvasMutation(...h),d(...h)},e.fontCb=(...h)=>{t.font&&t.font(...h),m(...h)}}function Gr(e,t={}){const n=e.doc.defaultView;if(!n)return()=>{};Ur(e,t);const r=Ht(e,e.doc),o=Or(e),i=Ar(e),l=Xt(e),a=Lr(e),c=Fr(e),s=$r(e),u=Pr(e,{win:n}),d=Wr(e,{win:n}),m=e.collectFonts?Vr(e):()=>{},h=[];for(const f of e.plugins)h.push(f.observer(f.callback,n,f.options));return()=>{me.forEach(f=>f.reset()),r.disconnect(),o(),i(),l(),a(),c(),s(),u(),d(),m(),h.forEach(f=>f())}}class jr{constructor(t){this.iframes=new WeakMap,this.mutationCb=t.mutationCb}addIframe(t){this.iframes.set(t,!0)}addLoadListener(t){this.loadListener=t}attachIframe(t,n,r){var o;this.mutationCb({adds:[{parentId:r.getId(t),nextId:null,node:n}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),(o=this.loadListener)==null||o.call(this,t)}}var Br=Object.defineProperty,zr=Object.defineProperties,Yr=Object.getOwnPropertyDescriptors,Qt=Object.getOwnPropertySymbols,Hr=Object.prototype.hasOwnProperty,Xr=Object.prototype.propertyIsEnumerable,qt=(e,t,n)=>t in e?Br(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Jt=(e,t)=>{for(var n in t||(t={}))Hr.call(t,n)&&qt(e,n,t[n]);if(Qt)for(var n of Qt(t))Xr.call(t,n)&&qt(e,n,t[n]);return e},en=(e,t)=>zr(e,Yr(t));class Zr{constructor(t){this.restorePatches=[],this.mutationCb=t.mutationCb,this.scrollCb=t.scrollCb,this.bypassOptions=t.bypassOptions,this.mirror=t.mirror;const n=this;this.restorePatches.push(de(HTMLElement.prototype,"attachShadow",function(r){return function(o){const i=r.call(this,o);return this.shadowRoot&&n.addShadowRoot(this.shadowRoot,this.ownerDocument),i}}))}addShadowRoot(t,n){!Re(t)||(Ht(en(Jt({},this.bypassOptions),{doc:n,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),t),Xt(en(Jt({},this.bypassOptions),{scrollCb:this.scrollCb,doc:t,mirror:this.mirror})))}observeAttachShadow(t){if(t.contentWindow){const n=this;this.restorePatches.push(de(t.contentWindow.HTMLElement.prototype,"attachShadow",function(r){return function(o){const i=r.call(this,o);return this.shadowRoot&&n.addShadowRoot(this.shadowRoot,t.contentDocument),i}}))}}reset(){this.restorePatches.forEach(t=>t())}}for(var Ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_e=typeof Uint8Array>"u"?[]:new Uint8Array(256),ze=0;ze<Ne.length;ze++)_e[Ne.charCodeAt(ze)]=ze;var Kr=function(e){var t=new Uint8Array(e),n,r=t.length,o="";for(n=0;n<r;n+=3)o+=Ne[t[n]>>2],o+=Ne[(t[n]&3)<<4|t[n+1]>>4],o+=Ne[(t[n+1]&15)<<2|t[n+2]>>6],o+=Ne[t[n+2]&63];return r%3===2?o=o.substring(0,o.length-1)+"=":r%3===1&&(o=o.substring(0,o.length-2)+"=="),o},Qr=function(e){var t=e.length*.75,n=e.length,r,o=0,i,l,a,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var s=new ArrayBuffer(t),u=new Uint8Array(s);for(r=0;r<n;r+=4)i=_e[e.charCodeAt(r)],l=_e[e.charCodeAt(r+1)],a=_e[e.charCodeAt(r+2)],c=_e[e.charCodeAt(r+3)],u[o++]=i<<2|l>>4,u[o++]=(l&15)<<4|a>>2,u[o++]=(a&3)<<6|c&63;return s};const tn=new Map;function qr(e,t){let n=tn.get(e);return n||(n=new Map,tn.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}const nn=(e,t,n)=>{if(!e||!(on(e,t)||typeof e=="object"))return;const r=e.constructor.name,o=qr(n,r);let i=o.indexOf(e);return i===-1&&(i=o.length,o.push(e)),i};function Ye(e,t,n){if(e instanceof Array)return e.map(r=>Ye(r,t,n));if(e===null)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray)return{rr_type:e.constructor.name,args:[Object.values(e)]};if(e instanceof ArrayBuffer){const r=e.constructor.name,o=Kr(e);return{rr_type:r,base64:o}}else{if(e instanceof DataView)return{rr_type:e.constructor.name,args:[Ye(e.buffer,t,n),e.byteOffset,e.byteLength]};if(e instanceof HTMLImageElement){const r=e.constructor.name,{src:o}=e;return{rr_type:r,src:o}}else if(e instanceof HTMLCanvasElement){const r="HTMLImageElement",o=e.toDataURL();return{rr_type:r,src:o}}else{if(e instanceof ImageData)return{rr_type:e.constructor.name,args:[Ye(e.data,t,n),e.width,e.height]};if(on(e,t)||typeof e=="object"){const r=e.constructor.name,o=nn(e,t,n);return{rr_type:r,index:o}}}}return e}const rn=(e,t,n)=>[...e].map(r=>Ye(r,t,n)),on=(e,t)=>{const n=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(r=>typeof t[r]=="function");return Boolean(n.find(r=>e instanceof t[r]))};function Jr(e,t,n,r){const o=[],i=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const l of i)try{if(typeof t.CanvasRenderingContext2D.prototype[l]!="function")continue;const a=de(t.CanvasRenderingContext2D.prototype,l,function(c){return function(...s){return te(this.canvas,n,!0)||setTimeout(()=>{const u=rn([...s],t,this);e(this.canvas,{type:ce["2D"],property:l,args:u})},0),c.apply(this,s)}});o.push(a)}catch{const c=Oe(t.CanvasRenderingContext2D.prototype,l,{set(s){e(this.canvas,{type:ce["2D"],property:l,args:[s],setter:!0})}});o.push(c)}return()=>{o.forEach(l=>l())}}function sn(e,t){const n=[];try{const r=de(e.HTMLCanvasElement.prototype,"getContext",function(o){return function(i,...l){return te(this,t,!0)||"__context"in this||(this.__context=i),o.apply(this,[i,...l])}});n.push(r)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{n.forEach(r=>r())}}function an(e,t,n,r,o,i){const l=[],a=Object.getOwnPropertyNames(e);for(const c of a)try{if(typeof e[c]!="function")continue;const s=de(e,c,function(u){return function(...d){const m=u.apply(this,d);if(nn(m,i,e),!te(this.canvas,r,!0)){const h=rn([...d],i,e),f={type:t,property:c,args:h};n(this.canvas,f)}return m}});l.push(s)}catch{const u=Oe(e,c,{set(d){n(this.canvas,{type:t,property:c,args:[d],setter:!0})}});l.push(u)}return l}function eo(e,t,n,r){const o=[];return o.push(...an(t.WebGLRenderingContext.prototype,ce.WebGL,e,n,r,t)),typeof t.WebGL2RenderingContext<"u"&&o.push(...an(t.WebGL2RenderingContext.prototype,ce.WebGL2,e,n,r,t)),()=>{o.forEach(i=>i())}}function to(e,t){var n=atob(e);if(t){for(var r=new Uint8Array(n.length),o=0,i=n.length;o<i;++o)r[o]=n.charCodeAt(o);return String.fromCharCode.apply(null,new Uint16Array(r.buffer))}return n}function no(e,t,n){var r=t===void 0?null:t,o=n===void 0?!1:n,i=to(e,o),l=i.indexOf(`
`,10)+1,a=i.substring(l)+(r?"//# sourceMappingURL="+r:""),c=new Blob([a],{type:"application/javascript"});return URL.createObjectURL(c)}function ro(e,t,n){var r;return function(i){return r=r||no(e,t,n),new Worker(r,i)}}var oo=ro("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Zm9yKHZhciByPSJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvIixsPXR5cGVvZiBVaW50OEFycmF5PiJ1Ij9bXTpuZXcgVWludDhBcnJheSgyNTYpLGY9MDtmPHIubGVuZ3RoO2YrKylsW3IuY2hhckNvZGVBdChmKV09Zjt2YXIgZD1mdW5jdGlvbihzKXt2YXIgZT1uZXcgVWludDhBcnJheShzKSxuLGE9ZS5sZW5ndGgsdD0iIjtmb3Iobj0wO248YTtuKz0zKXQrPXJbZVtuXT4+Ml0sdCs9clsoZVtuXSYzKTw8NHxlW24rMV0+PjRdLHQrPXJbKGVbbisxXSYxNSk8PDJ8ZVtuKzJdPj42XSx0Kz1yW2VbbisyXSY2M107cmV0dXJuIGElMz09PTI/dD10LnN1YnN0cmluZygwLHQubGVuZ3RoLTEpKyI9IjphJTM9PT0xJiYodD10LnN1YnN0cmluZygwLHQubGVuZ3RoLTIpKyI9PSIpLHR9O2NvbnN0IGM9bmV3IE1hcCx1PW5ldyBNYXA7YXN5bmMgZnVuY3Rpb24gcChzLGUpe2NvbnN0IG49YCR7c30tJHtlfWA7aWYodS5oYXMobikpcmV0dXJuIHUuZ2V0KG4pO2NvbnN0IGE9bmV3IE9mZnNjcmVlbkNhbnZhcyhzLGUpO2EuZ2V0Q29udGV4dCgiMmQiKTtjb25zdCB0PWF3YWl0KGF3YWl0IGEuY29udmVydFRvQmxvYigpKS5hcnJheUJ1ZmZlcigpLGc9ZCh0KTtyZXR1cm4gdS5zZXQobixnKSxnfWNvbnN0IGk9c2VsZjtpLm9ubWVzc2FnZT1hc3luYyBmdW5jdGlvbihzKXtpZighKCJPZmZzY3JlZW5DYW52YXMiaW4gZ2xvYmFsVGhpcykpcmV0dXJuIGkucG9zdE1lc3NhZ2Uoe2lkOnMuZGF0YS5pZH0pO2NvbnN0e2lkOmUsYml0bWFwOm4sd2lkdGg6YSxoZWlnaHQ6dH09cy5kYXRhLGc9cChhLHQpLGg9bmV3IE9mZnNjcmVlbkNhbnZhcyhhLHQpO2guZ2V0Q29udGV4dCgiMmQiKS5kcmF3SW1hZ2UobiwwLDApLG4uY2xvc2UoKTtjb25zdCB3PWF3YWl0IGguY29udmVydFRvQmxvYigpLHk9dy50eXBlLGI9YXdhaXQgdy5hcnJheUJ1ZmZlcigpLG89ZChiKTtpZighYy5oYXMoZSkmJmF3YWl0IGc9PT1vKXJldHVybiBjLnNldChlLG8pLGkucG9zdE1lc3NhZ2Uoe2lkOmV9KTtpZihjLmdldChlKT09PW8pcmV0dXJuIGkucG9zdE1lc3NhZ2Uoe2lkOmV9KTtpLnBvc3RNZXNzYWdlKHtpZDplLHR5cGU6eSxiYXNlNjQ6byx3aWR0aDphLGhlaWdodDp0fSksYy5zZXQoZSxvKX19KSgpOwoK",null,!1),ln=Object.getOwnPropertySymbols,so=Object.prototype.hasOwnProperty,io=Object.prototype.propertyIsEnumerable,ao=(e,t)=>{var n={};for(var r in e)so.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&ln)for(var r of ln(e))t.indexOf(r)<0&&io.call(e,r)&&(n[r]=e[r]);return n},lo=(e,t,n)=>new Promise((r,o)=>{var i=c=>{try{a(n.next(c))}catch(s){o(s)}},l=c=>{try{a(n.throw(c))}catch(s){o(s)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(i,l);a((n=n.apply(e,t)).next())});class co{constructor(t){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(l,a)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(l)||this.pendingCanvasMutations.set(l,[]),this.pendingCanvasMutations.get(l).push(a)};const{sampling:n="all",win:r,blockClass:o,recordCanvas:i}=t;this.mutationCb=t.mutationCb,this.mirror=t.mirror,i&&n==="all"&&this.initCanvasMutationObserver(r,o),i&&typeof n=="number"&&this.initCanvasFPSObserver(n,r,o)}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(t,n,r){const o=sn(n,r),i=new Map,l=new oo;l.onmessage=d=>{const{id:m}=d.data;if(i.set(m,!1),!("base64"in d.data))return;const{base64:h,type:f,width:g,height:S}=d.data;this.mutationCb({id:m,type:ce["2D"],commands:[{property:"clearRect",args:[0,0,g,S]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:h}],type:f}]},0,0]}]})};const a=1e3/t;let c=0,s;const u=d=>{if(c&&d-c<a){s=requestAnimationFrame(u);return}c=d,n.document.querySelectorAll(`canvas:not(.${r} *)`).forEach(m=>lo(this,null,function*(){var h;const f=this.mirror.getId(m);if(i.get(f))return;if(i.set(f,!0),["webgl","webgl2"].includes(m.__context)){const S=m.getContext(m.__context);((h=S?.getContextAttributes())==null?void 0:h.preserveDrawingBuffer)===!1&&S?.clear(S.COLOR_BUFFER_BIT)}const g=yield createImageBitmap(m);l.postMessage({id:f,bitmap:g,width:m.width,height:m.height},[g])})),s=requestAnimationFrame(u)};s=requestAnimationFrame(u),this.resetObservers=()=>{o(),cancelAnimationFrame(s)}}initCanvasMutationObserver(t,n){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const r=sn(t,n),o=Jr(this.processMutation.bind(this),t,n,this.mirror),i=eo(this.processMutation.bind(this),t,n,this.mirror);this.resetObservers=()=>{r(),o(),i()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const t=n=>{this.rafStamps.latestId=n,requestAnimationFrame(t)};requestAnimationFrame(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((t,n)=>{const r=this.mirror.getId(n);this.flushPendingCanvasMutationFor(n,r)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(t,n){if(this.frozen||this.locked)return;const r=this.pendingCanvasMutations.get(t);if(!r||n===-1)return;const o=r.map(l=>ao(l,["type"])),{type:i}=r[0];this.mutationCb({id:n,type:i,commands:o}),this.pendingCanvasMutations.delete(t)}}class uo{constructor(t){this.trackedStylesheets=new WeakSet,this.mutationCb=t.mutationCb}addStylesheet(t){this.trackedStylesheets.has(t)||(this.trackedStylesheets.add(t),this.trackStylesheet(t))}trackStylesheet(t){}attachStylesheet(t,n,r){this.mutationCb({adds:[{parentId:r.getId(t),nextId:null,node:n}],removes:[],texts:[],attributes:[]}),this.addStylesheet(t)}}var ho=Object.defineProperty,mo=Object.defineProperties,po=Object.getOwnPropertyDescriptors,cn=Object.getOwnPropertySymbols,fo=Object.prototype.hasOwnProperty,go=Object.prototype.propertyIsEnumerable,un=(e,t,n)=>t in e?ho(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ne=(e,t)=>{for(var n in t||(t={}))fo.call(t,n)&&un(e,n,t[n]);if(cn)for(var n of cn(t))go.call(t,n)&&un(e,n,t[n]);return e},yo=(e,t)=>mo(e,po(t));function Y(e){return yo(ne({},e),{timestamp:Date.now()})}let G,Fe;const se=wt();function pe(e={}){const{emit:t,checkoutEveryNms:n,checkoutEveryNth:r,blockClass:o="rr-block",blockSelector:i=null,ignoreClass:l="rr-ignore",maskTextClass:a="rr-mask",maskTextSelector:c=null,inlineStylesheet:s=!0,maskAllInputs:u,maskInputOptions:d,slimDOMOptions:m,maskInputFn:h,maskTextFn:f,hooks:g,packFn:S,sampling:p={},mousemoveWait:b,recordCanvas:v=!1,userTriggeredOnInput:C=!1,collectFonts:A=!1,inlineImages:k=!1,plugins:F,keepIframeSrcFn:_=()=>!1}=e;if(!t)throw new Error("emit function is required");b!==void 0&&p.mousemove===void 0&&(p.mousemove=b),se.reset();const J=u===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:d!==void 0?d:{password:!0},H=m===!0||m==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:m==="all",headMetaDescKeywords:m==="all"}:m||{};rt();let B,Z=0;const W=N=>{for(const T of F||[])T.eventProcessor&&(N=T.eventProcessor(N));return S&&(N=S(N)),N};G=(N,T)=>{var P;if(((P=me[0])==null?void 0:P.isFrozen())&&N.type!==E.FullSnapshot&&!(N.type===E.IncrementalSnapshot&&N.data.source===I.Mutation)&&me.forEach(U=>U.unfreeze()),t(W(N),T),N.type===E.FullSnapshot)B=N,Z=0;else if(N.type===E.IncrementalSnapshot){if(N.data.source===I.Mutation&&N.data.isAttachIframe)return;Z++;const U=r&&Z>=r,ae=n&&N.timestamp-B.timestamp>n;(U||ae)&&Fe(!0)}};const K=N=>{G(Y({type:E.IncrementalSnapshot,data:ne({source:I.Mutation},N)}))},Q=N=>G(Y({type:E.IncrementalSnapshot,data:ne({source:I.Scroll},N)})),z=N=>G(Y({type:E.IncrementalSnapshot,data:ne({source:I.CanvasMutation},N)})),R=new jr({mutationCb:K}),X=new uo({mutationCb:K}),w=new co({recordCanvas:v,mutationCb:z,win:window,blockClass:o,mirror:se,sampling:p.canvas}),y=new Zr({mutationCb:K,scrollCb:Q,bypassOptions:{blockClass:o,blockSelector:i,maskTextClass:a,maskTextSelector:c,inlineStylesheet:s,maskInputOptions:J,maskTextFn:f,maskInputFn:h,recordCanvas:v,inlineImages:k,sampling:p,slimDOMOptions:H,iframeManager:R,stylesheetManager:X,canvasManager:w},mirror:se});Fe=(N=!1)=>{var T,P,U,ae;G(Y({type:E.Meta,data:{href:window.location.href,width:et(),height:Je()}}),N),me.forEach(V=>V.lock());const O=pr(document,{mirror:se,blockClass:o,blockSelector:i,maskTextClass:a,maskTextSelector:c,inlineStylesheet:s,maskAllInputs:J,maskTextFn:f,slimDOM:H,recordCanvas:v,inlineImages:k,onSerialize:V=>{Se(V,se)&&R.addIframe(V),st(V,se)&&X.addStylesheet(V),Ae(V)&&y.addShadowRoot(V.shadowRoot,document)},onIframeLoad:(V,fe)=>{R.attachIframe(V,fe,se),y.observeAttachShadow(V)},onStylesheetLoad:(V,fe)=>{X.attachStylesheet(V,fe,se)},keepIframeSrcFn:_});if(!O)return console.warn("Failed to snapshot the document");G(Y({type:E.FullSnapshot,data:{node:O,initialOffset:{left:window.pageXOffset!==void 0?window.pageXOffset:document?.documentElement.scrollLeft||((P=(T=document?.body)==null?void 0:T.parentElement)==null?void 0:P.scrollLeft)||document?.body.scrollLeft||0,top:window.pageYOffset!==void 0?window.pageYOffset:document?.documentElement.scrollTop||((ae=(U=document?.body)==null?void 0:U.parentElement)==null?void 0:ae.scrollTop)||document?.body.scrollTop||0}}})),me.forEach(V=>V.unlock())};try{const N=[];N.push(ee("DOMContentLoaded",()=>{G(Y({type:E.DomContentLoaded,data:{}}))}));const T=U=>{var ae;return Gr({mutationCb:K,mousemoveCb:(O,V)=>G(Y({type:E.IncrementalSnapshot,data:{source:V,positions:O}})),mouseInteractionCb:O=>G(Y({type:E.IncrementalSnapshot,data:ne({source:I.MouseInteraction},O)})),scrollCb:Q,viewportResizeCb:O=>G(Y({type:E.IncrementalSnapshot,data:ne({source:I.ViewportResize},O)})),inputCb:O=>G(Y({type:E.IncrementalSnapshot,data:ne({source:I.Input},O)})),mediaInteractionCb:O=>G(Y({type:E.IncrementalSnapshot,data:ne({source:I.MediaInteraction},O)})),styleSheetRuleCb:O=>G(Y({type:E.IncrementalSnapshot,data:ne({source:I.StyleSheetRule},O)})),styleDeclarationCb:O=>G(Y({type:E.IncrementalSnapshot,data:ne({source:I.StyleDeclaration},O)})),canvasMutationCb:z,fontCb:O=>G(Y({type:E.IncrementalSnapshot,data:ne({source:I.Font},O)})),blockClass:o,ignoreClass:l,maskTextClass:a,maskTextSelector:c,maskInputOptions:J,inlineStylesheet:s,sampling:p,recordCanvas:v,inlineImages:k,userTriggeredOnInput:C,collectFonts:A,doc:U,maskInputFn:h,maskTextFn:f,blockSelector:i,slimDOMOptions:H,mirror:se,iframeManager:R,stylesheetManager:X,shadowDomManager:y,canvasManager:w,plugins:((ae=F?.filter(O=>O.observer))==null?void 0:ae.map(O=>({observer:O.observer,options:O.options,callback:V=>G(Y({type:E.Plugin,data:{plugin:O.name,payload:V}}))})))||[]},g)};R.addLoadListener(U=>{N.push(T(U.contentDocument))});const P=()=>{Fe(),N.push(T(document))};return document.readyState==="interactive"||document.readyState==="complete"?P():N.push(ee("load",()=>{G(Y({type:E.Load,data:{}})),P()},window)),()=>{N.forEach(U=>U())}}catch(N){console.warn(N)}}pe.addCustomEvent=(e,t)=>{if(!G)throw new Error("please add custom event after start recording");G(Y({type:E.Custom,data:{tag:e,payload:t}}))},pe.freezePage=()=>{me.forEach(e=>e.freeze())},pe.takeFullSnapshot=e=>{if(!Fe)throw new Error("please take full snapshot after start recording");Fe(e)},pe.mirror=se;var x;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(x||(x={}));var vo=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(t){var n;if(!t)return-1;var r=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return r??-1},e.prototype.getNode=function(t){return this.idNodeMap.get(t)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(t){return this.nodeMetaMap.get(t)||null},e.prototype.removeNodeFromMap=function(t){var n=this,r=this.getId(t);this.idNodeMap.delete(r),t.childNodes&&t.childNodes.forEach(function(o){return n.removeNodeFromMap(o)})},e.prototype.has=function(t){return this.idNodeMap.has(t)},e.prototype.hasNode=function(t){return this.nodeMetaMap.has(t)},e.prototype.add=function(t,n){var r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)},e.prototype.replace=function(t,n){this.idNodeMap.set(t,n)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function bo(){return new vo}function So(e){const t={},n=/;(?![^(]*\))/g,r=/:(.+)/,o=/\/\*.*?\*\//g;return e.replace(o,"").split(n).forEach(function(i){if(i){const l=i.split(r);l.length>1&&(t[ct(l[0].trim())]=l[1].trim())}}),t}function dn(e){const t=[];for(const n in e){const r=e[n];if(typeof r!="string")continue;const o=Eo(n);t.push(`${o}: ${r};`)}return t.join(" ")}const wo=/-([a-z])/g,No=/^--[a-zA-Z0-9-]+$/,ct=e=>No.test(e)?e:e.replace(wo,(t,n)=>n?n.toUpperCase():""),To=/\B([A-Z])/g,Eo=e=>e.replace(To,"-$1").toLowerCase();class re{constructor(...t){this.childNodes=[],this.parentElement=null,this.parentNode=null,this.ELEMENT_NODE=$.ELEMENT_NODE,this.TEXT_NODE=$.TEXT_NODE}get firstChild(){return this.childNodes[0]||null}get lastChild(){return this.childNodes[this.childNodes.length-1]||null}get nextSibling(){const t=this.parentNode;if(!t)return null;const n=t.childNodes,r=n.indexOf(this);return n[r+1]||null}contains(t){if(t===this)return!0;for(const n of this.childNodes)if(n.contains(t))return!0;return!1}appendChild(t){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(t,n){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(t){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}function Co(e){return class Gn extends e{constructor(){super(...arguments),this.nodeType=$.DOCUMENT_NODE,this.nodeName="#document",this.compatMode="CSS1Compat",this.RRNodeType=x.Document,this.textContent=null}get documentElement(){return this.childNodes.find(n=>n.RRNodeType===x.Element&&n.tagName==="HTML")||null}get body(){var n;return((n=this.documentElement)===null||n===void 0?void 0:n.childNodes.find(r=>r.RRNodeType===x.Element&&r.tagName==="BODY"))||null}get head(){var n;return((n=this.documentElement)===null||n===void 0?void 0:n.childNodes.find(r=>r.RRNodeType===x.Element&&r.tagName==="HEAD"))||null}get implementation(){return this}get firstElementChild(){return this.documentElement}appendChild(n){const r=n.RRNodeType;if((r===x.Element||r===x.DocumentType)&&this.childNodes.some(o=>o.RRNodeType===r))throw new Error(`RRDomException: Failed to execute 'appendChild' on 'RRNode': Only one ${r===x.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);return n.parentElement=null,n.parentNode=this,this.childNodes.push(n),n}insertBefore(n,r){const o=n.RRNodeType;if((o===x.Element||o===x.DocumentType)&&this.childNodes.some(l=>l.RRNodeType===o))throw new Error(`RRDomException: Failed to execute 'insertBefore' on 'RRNode': Only one ${o===x.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);if(r===null)return this.appendChild(n);const i=this.childNodes.indexOf(r);if(i==-1)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return this.childNodes.splice(i,0,n),n.parentElement=null,n.parentNode=this,n}removeChild(n){const r=this.childNodes.indexOf(n);if(r===-1)throw new Error("Failed to execute 'removeChild' on 'RRDocument': The RRNode to be removed is not a child of this RRNode.");return this.childNodes.splice(r,1),n.parentElement=null,n.parentNode=null,n}open(){this.childNodes=[]}close(){}write(n){let r;if(n==='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'?r="-//W3C//DTD XHTML 1.0 Transitional//EN":n==='<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">'&&(r="-//W3C//DTD HTML 4.0 Transitional//EN"),r){const o=this.createDocumentType("html",r,"");this.open(),this.appendChild(o)}}createDocument(n,r,o){return new Gn}createDocumentType(n,r,o){const i=new(hn(re))(n,r,o);return i.ownerDocument=this,i}createElement(n){const r=new(mn(re))(n);return r.ownerDocument=this,r}createElementNS(n,r){return this.createElement(r)}createTextNode(n){const r=new(pn(re))(n);return r.ownerDocument=this,r}createComment(n){const r=new(fn(re))(n);return r.ownerDocument=this,r}createCDATASection(n){const r=new(gn(re))(n);return r.ownerDocument=this,r}toString(){return"RRDocument"}}}function hn(e){return class extends e{constructor(t,n,r){super(),this.nodeType=$.DOCUMENT_TYPE_NODE,this.RRNodeType=x.DocumentType,this.textContent=null,this.name=t,this.publicId=n,this.systemId=r,this.nodeName=t}toString(){return"RRDocumentType"}}}function mn(e){return class extends e{constructor(t){super(),this.nodeType=$.ELEMENT_NODE,this.RRNodeType=x.Element,this.attributes={},this.shadowRoot=null,this.tagName=t.toUpperCase(),this.nodeName=t.toUpperCase()}get textContent(){let t="";return this.childNodes.forEach(n=>t+=n.textContent),t}set textContent(t){this.childNodes=[this.ownerDocument.createTextNode(t)]}get classList(){return new Mo(this.attributes.class,t=>{this.attributes.class=t})}get id(){return this.attributes.id||""}get className(){return this.attributes.class||""}get style(){const t=this.attributes.style?So(this.attributes.style):{},n=/\B([A-Z])/g;return t.setProperty=(r,o,i)=>{if(n.test(r))return;const l=ct(r);o?t[l]=o:delete t[l],i==="important"&&(t[l]+=" !important"),this.attributes.style=dn(t)},t.removeProperty=r=>{if(n.test(r))return"";const o=ct(r),i=t[o]||"";return delete t[o],this.attributes.style=dn(t),i},t}getAttribute(t){return this.attributes[t]||null}setAttribute(t,n){this.attributes[t]=n}setAttributeNS(t,n,r){this.setAttribute(n,r)}removeAttribute(t){delete this.attributes[t]}appendChild(t){return this.childNodes.push(t),t.parentNode=this,t.parentElement=this,t}insertBefore(t,n){if(n===null)return this.appendChild(t);const r=this.childNodes.indexOf(n);if(r==-1)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return this.childNodes.splice(r,0,t),t.parentElement=this,t.parentNode=this,t}removeChild(t){const n=this.childNodes.indexOf(t);if(n===-1)throw new Error("Failed to execute 'removeChild' on 'RRElement': The RRNode to be removed is not a child of this RRNode.");return this.childNodes.splice(n,1),t.parentElement=null,t.parentNode=null,t}attachShadow(t){const n=this.ownerDocument.createElement("SHADOWROOT");return this.shadowRoot=n,n}dispatchEvent(t){return!0}toString(){let t="";for(const n in this.attributes)t+=`${n}="${this.attributes[n]}" `;return`${this.tagName} ${t}`}}}function Io(e){return class extends e{attachShadow(t){throw new Error("RRDomException: Failed to execute 'attachShadow' on 'RRElement': This RRElement does not support attachShadow")}play(){this.paused=!1}pause(){this.paused=!0}}}function pn(e){return class extends e{constructor(t){super(),this.nodeType=$.TEXT_NODE,this.nodeName="#text",this.RRNodeType=x.Text,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRText text=${JSON.stringify(this.data)}`}}}function fn(e){return class extends e{constructor(t){super(),this.nodeType=$.COMMENT_NODE,this.nodeName="#comment",this.RRNodeType=x.Comment,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRComment text=${JSON.stringify(this.data)}`}}}function gn(e){return class extends e{constructor(t){super(),this.nodeName="#cdata-section",this.nodeType=$.CDATA_SECTION_NODE,this.RRNodeType=x.CDATA,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRCDATASection data=${JSON.stringify(this.data)}`}}}class Mo{constructor(t,n){if(this.classes=[],this.add=(...r)=>{for(const o of r){const i=String(o);this.classes.indexOf(i)>=0||this.classes.push(i)}this.onChange&&this.onChange(this.classes.join(" "))},this.remove=(...r)=>{this.classes=this.classes.filter(o=>r.indexOf(o)===-1),this.onChange&&this.onChange(this.classes.join(" "))},t){const r=t.trim().split(/\s+/);this.classes.push(...r)}this.onChange=n}}var $;(function(e){e[e.PLACEHOLDER=0]="PLACEHOLDER",e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",e[e.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",e[e.ENTITY_NODE=6]="ENTITY_NODE",e[e.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE",e[e.DOCUMENT_NODE=9]="DOCUMENT_NODE",e[e.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",e[e.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE"})($||($={}));const ut={svg:"http://www.w3.org/2000/svg","xlink:href":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},xo={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function ie(e,t,n,r){const o=e.childNodes,i=t.childNodes;r=r||t.mirror||t.ownerDocument.mirror,(o.length>0||i.length>0)&&yn(Array.from(o),i,e,n,r);let l=null,a=null;switch(t.RRNodeType){case x.Document:{a=t.scrollData;break}case x.Element:{const c=e,s=t;switch(Do(c,s,r),a=s.scrollData,l=s.inputData,s.tagName){case"AUDIO":case"VIDEO":{const u=e,d=s;d.paused!==void 0&&(d.paused?u.pause():u.play()),d.muted!==void 0&&(u.muted=d.muted),d.volume!==void 0&&(u.volume=d.volume),d.currentTime!==void 0&&(u.currentTime=d.currentTime);break}case"CANVAS":{const u=t;if(u.rr_dataURL!==null){const d=document.createElement("img");d.onload=()=>{const m=c.getContext("2d");m&&m.drawImage(d,0,0,d.width,d.height)},d.src=u.rr_dataURL}u.canvasMutations.forEach(d=>n.applyCanvas(d.event,d.mutation,e))}break;case"STYLE":Ro(c,t.rules);break}if(s.shadowRoot){c.shadowRoot||c.attachShadow({mode:"open"});const u=c.shadowRoot.childNodes,d=s.shadowRoot.childNodes;(u.length>0||d.length>0)&&yn(Array.from(u),d,c.shadowRoot,n,r)}break}case x.Text:case x.Comment:case x.CDATA:e.textContent!==t.data&&(e.textContent=t.data);break}if(a&&n.applyScroll(a,!0),l&&n.applyInput(l),t.nodeName==="IFRAME"){const c=e.contentDocument,s=t;if(c){const u=r.getMeta(s.contentDocument);u&&n.mirror.add(c,Object.assign({},u)),ie(c,s.contentDocument,n,r)}}}function Do(e,t,n){const r=e.attributes,o=t.attributes;for(const i in o){const l=o[i],a=n.getMeta(t);if(a&&"isSVG"in a&&a.isSVG&&ut[i])e.setAttributeNS(ut[i],i,l);else if(t.tagName==="CANVAS"&&i==="rr_dataURL"){const c=document.createElement("img");c.src=l,c.onload=()=>{const s=e.getContext("2d");s&&s.drawImage(c,0,0,c.width,c.height)}}else e.setAttribute(i,l)}for(const{name:i}of Array.from(r))i in o||e.removeAttribute(i);t.scrollLeft&&(e.scrollLeft=t.scrollLeft),t.scrollTop&&(e.scrollTop=t.scrollTop)}function yn(e,t,n,r,o){var i;let l=0,a=e.length-1,c=0,s=t.length-1,u=e[l],d=e[a],m=t[c],h=t[s],f,g;for(;l<=a&&c<=s;)if(u===void 0)u=e[++l];else if(d===void 0)d=e[--a];else if(r.mirror.getId(u)===o.getId(m))ie(u,m,r,o),u=e[++l],m=t[++c];else if(r.mirror.getId(d)===o.getId(h))ie(d,h,r,o),d=e[--a],h=t[--s];else if(r.mirror.getId(u)===o.getId(h))n.insertBefore(u,d.nextSibling),ie(u,h,r,o),u=e[++l],h=t[--s];else if(r.mirror.getId(d)===o.getId(m))n.insertBefore(d,u),ie(d,m,r,o),d=e[--a],m=t[++c];else{if(!f){f={};for(let S=l;S<=a;S++){const p=e[S];p&&r.mirror.hasNode(p)&&(f[r.mirror.getId(p)]=S)}}if(g=f[o.getId(m)],g){const S=e[g];n.insertBefore(S,u),ie(S,m,r,o),e[g]=void 0}else{const S=dt(m,r.mirror,o);n.nodeName==="#document"&&((i=r.mirror.getMeta(S))===null||i===void 0?void 0:i.type)===x.Element&&n.documentElement&&(n.removeChild(n.documentElement),e[l]=void 0,u=void 0),n.insertBefore(S,u||null),ie(S,m,r,o)}m=t[++c]}if(l>a){const S=t[s+1];let p=null;for(S&&n.childNodes.forEach(b=>{r.mirror.getId(b)===o.getId(S)&&(p=b)});c<=s;++c){const b=dt(t[c],r.mirror,o);n.insertBefore(b,p),ie(b,t[c],r,o)}}else if(c>s)for(;l<=a;l++){const S=e[l];S&&(n.removeChild(S),r.mirror.removeNodeFromMap(S))}}function dt(e,t,n){let r=t.getNode(n.getId(e));const o=n.getMeta(e);if(r!==null)return r;switch(e.RRNodeType){case x.Document:r=new Document;break;case x.DocumentType:r=document.implementation.createDocumentType(e.name,e.publicId,e.systemId);break;case x.Element:{let i=e.tagName.toLowerCase();i=xo[i]||i,o&&"isSVG"in o&&o?.isSVG?r=document.createElementNS(ut.svg,i):r=document.createElement(e.tagName);break}case x.Text:r=document.createTextNode(e.data);break;case x.Comment:r=document.createComment(e.data);break;case x.CDATA:r=document.createCDATASection(e.data);break}return o&&t.add(r,Object.assign({},o)),r}function Pe(e,t){const n=e[t[0]];return t.length===1?n:Pe(n.cssRules[t[1]].cssRules,t.slice(2))}var oe;(function(e){e[e.Insert=0]="Insert",e[e.Remove=1]="Remove",e[e.Snapshot=2]="Snapshot",e[e.SetProperty=3]="SetProperty",e[e.RemoveProperty=4]="RemoveProperty"})(oe||(oe={}));function vn(e){const t=[...e],n=t.pop();return{positions:t,index:n}}function Ro(e,t){const n=e.sheet;t.forEach(r=>{if(r.type===oe.Insert)try{if(Array.isArray(r.index)){const{positions:o,index:i}=vn(r.index);Pe(n.cssRules,o).insertRule(r.cssText,i)}else n.insertRule(r.cssText,r.index)}catch{}else if(r.type===oe.Remove)try{if(Array.isArray(r.index)){const{positions:o,index:i}=vn(r.index);Pe(n.cssRules,o).deleteRule(i||0)}else n.deleteRule(r.index)}catch{}else r.type===oe.SetProperty?Pe(n.cssRules,r.index).style.setProperty(r.property,r.value,r.priority):r.type===oe.RemoveProperty&&Pe(n.cssRules,r.index).style.removeProperty(r.property)})}class Te extends Co(re){constructor(t){super(),this._unserializedId=-1,this.mirror=Uo(),this.scrollData=null,t&&(this.mirror=t)}get unserializedId(){return this._unserializedId--}createDocument(t,n,r){return new Te}createDocumentType(t,n,r){const o=new ko(t,n,r);return o.ownerDocument=this,o}createElement(t){const n=t.toUpperCase();let r;switch(n){case"AUDIO":case"VIDEO":r=new Oo(n);break;case"IFRAME":r=new _o(n,this.mirror);break;case"CANVAS":r=new Ao(n);break;case"STYLE":r=new Lo(n);break;default:r=new We(n);break}return r.ownerDocument=this,r}createComment(t){const n=new Po(t);return n.ownerDocument=this,n}createCDATASection(t){const n=new Wo(t);return n.ownerDocument=this,n}createTextNode(t){const n=new Fo(t);return n.ownerDocument=this,n}destroyTree(){this.childNodes=[],this.mirror.reset()}open(){super.open(),this._unserializedId=-1}}const ko=hn(re);class We extends mn(re){constructor(){super(...arguments),this.inputData=null,this.scrollData=null}}class Oo extends Io(We){}class Ao extends We{constructor(){super(...arguments),this.rr_dataURL=null,this.canvasMutations=[]}getContext(){return null}}class Lo extends We{constructor(){super(...arguments),this.rules=[]}}class _o extends We{constructor(t,n){super(t),this.contentDocument=new Te,this.contentDocument.mirror=n}}const Fo=pn(re),Po=fn(re),Wo=gn(re);function $o(e){return e instanceof HTMLFormElement?"FORM":e.tagName.toUpperCase()}function bn(e,t,n,r){let o;switch(e.nodeType){case $.DOCUMENT_NODE:r&&r.nodeName==="IFRAME"?o=r.contentDocument:(o=t,o.compatMode=e.compatMode);break;case $.DOCUMENT_TYPE_NODE:{const l=e;o=t.createDocumentType(l.name,l.publicId,l.systemId);break}case $.ELEMENT_NODE:{const l=e,a=$o(l);o=t.createElement(a);const c=o;for(const{name:s,value:u}of Array.from(l.attributes))c.attributes[s]=u;l.scrollLeft&&(c.scrollLeft=l.scrollLeft),l.scrollTop&&(c.scrollTop=l.scrollTop);break}case $.TEXT_NODE:o=t.createTextNode(e.textContent||"");break;case $.CDATA_SECTION_NODE:o=t.createCDATASection(e.data);break;case $.COMMENT_NODE:o=t.createComment(e.textContent||"");break;case $.DOCUMENT_FRAGMENT_NODE:o=r.attachShadow({mode:"open"});break;default:return null}let i=n.getMeta(e);return t instanceof Te&&(i||(i=Sn(o,t.unserializedId),n.add(e,i)),t.mirror.add(o,Object.assign({},i))),o}function Vo(e,t=bo(),n=new Te){function r(o,i){const l=bn(o,n,t,i);l!==null&&(i?.nodeName!=="IFRAME"&&o.nodeType!==$.DOCUMENT_FRAGMENT_NODE&&(i?.appendChild(l),l.parentNode=i,l.parentElement=i),o.nodeName==="IFRAME"?r(o.contentDocument,l):(o.nodeType===$.DOCUMENT_NODE||o.nodeType===$.ELEMENT_NODE||o.nodeType===$.DOCUMENT_FRAGMENT_NODE)&&(o.nodeType===$.ELEMENT_NODE&&o.shadowRoot&&r(o.shadowRoot,l),o.childNodes.forEach(a=>r(a,l))))}return r(e,null),n}function Uo(){return new Go}class Go{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(t){var n;if(!t)return-1;const r=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return r??-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const n=this.getId(t);this.idNodeMap.delete(n),t.childNodes&&t.childNodes.forEach(r=>this.removeNodeFromMap(r))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,n){const r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)}replace(t,n){this.idNodeMap.set(t,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function Sn(e,t){switch(e.RRNodeType){case x.Document:return{id:t,type:e.RRNodeType,childNodes:[]};case x.DocumentType:{const n=e;return{id:t,type:e.RRNodeType,name:n.name,publicId:n.publicId,systemId:n.systemId}}case x.Element:return{id:t,type:e.RRNodeType,tagName:e.tagName.toLowerCase(),attributes:{},childNodes:[]};case x.Text:return{id:t,type:e.RRNodeType,textContent:e.textContent||""};case x.Comment:return{id:t,type:e.RRNodeType,textContent:e.textContent||""};case x.CDATA:return{id:t,type:e.RRNodeType,textContent:""}}}function wn(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(o){o(n)}),(r=e.get("*"))&&r.slice().map(function(o){o(t,n)})}}}var jo=Object.freeze({__proto__:null,default:wn});function Bo(e=window,t=document){if("scrollBehavior"in t.documentElement.style&&e.__forceSmoothScrollPolyfill__!==!0)return;const n=e.HTMLElement||e.Element,r=468,o={scroll:e.scroll||e.scrollTo,scrollBy:e.scrollBy,elementScroll:n.prototype.scroll||c,scrollIntoView:n.prototype.scrollIntoView},i=e.performance&&e.performance.now?e.performance.now.bind(e.performance):Date.now;function l(p){const b=["MSIE ","Trident/","Edge/"];return new RegExp(b.join("|")).test(p)}const a=l(e.navigator.userAgent)?1:0;function c(p,b){this.scrollLeft=p,this.scrollTop=b}function s(p){return .5*(1-Math.cos(Math.PI*p))}function u(p){if(p===null||typeof p!="object"||p.behavior===void 0||p.behavior==="auto"||p.behavior==="instant")return!0;if(typeof p=="object"&&p.behavior==="smooth")return!1;throw new TypeError("behavior member of ScrollOptions "+p.behavior+" is not a valid value for enumeration ScrollBehavior.")}function d(p,b){if(b==="Y")return p.clientHeight+a<p.scrollHeight;if(b==="X")return p.clientWidth+a<p.scrollWidth}function m(p,b){const v=e.getComputedStyle(p,null)["overflow"+b];return v==="auto"||v==="scroll"}function h(p){const b=d(p,"Y")&&m(p,"Y"),v=d(p,"X")&&m(p,"X");return b||v}function f(p){for(;p!==t.body&&h(p)===!1;)p=p.parentNode||p.host;return p}function g(p){const b=i();let v,C,A,k=(b-p.startTime)/r;k=k>1?1:k,v=s(k),C=p.startX+(p.x-p.startX)*v,A=p.startY+(p.y-p.startY)*v,p.method.call(p.scrollable,C,A),(C!==p.x||A!==p.y)&&e.requestAnimationFrame(g.bind(e,p))}function S(p,b,v){let C,A,k,F;const _=i();p===t.body?(C=e,A=e.scrollX||e.pageXOffset,k=e.scrollY||e.pageYOffset,F=o.scroll):(C=p,A=p.scrollLeft,k=p.scrollTop,F=c),g({scrollable:C,method:F,startTime:_,startX:A,startY:k,x:b,y:v})}e.scroll=e.scrollTo=function(){if(arguments[0]!==void 0){if(u(arguments[0])===!0){o.scroll.call(e,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:e.scrollX||e.pageXOffset,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:e.scrollY||e.pageYOffset);return}S.call(e,t.body,arguments[0].left!==void 0?~~arguments[0].left:e.scrollX||e.pageXOffset,arguments[0].top!==void 0?~~arguments[0].top:e.scrollY||e.pageYOffset)}},e.scrollBy=function(){if(arguments[0]!==void 0){if(u(arguments[0])){o.scrollBy.call(e,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:0,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:0);return}S.call(e,t.body,~~arguments[0].left+(e.scrollX||e.pageXOffset),~~arguments[0].top+(e.scrollY||e.pageYOffset))}},n.prototype.scroll=n.prototype.scrollTo=function(){if(arguments[0]===void 0)return;if(u(arguments[0])===!0){if(typeof arguments[0]=="number"&&arguments[1]===void 0)throw new SyntaxError("Value could not be converted");o.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left:typeof arguments[0]!="object"?~~arguments[0]:this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top:arguments[1]!==void 0?~~arguments[1]:this.scrollTop);return}const p=arguments[0].left,b=arguments[0].top;S.call(this,this,typeof p>"u"?this.scrollLeft:~~p,typeof b>"u"?this.scrollTop:~~b)},n.prototype.scrollBy=function(){if(arguments[0]!==void 0){if(u(arguments[0])===!0){o.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop);return}this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior})}},n.prototype.scrollIntoView=function(){if(u(arguments[0])===!0){o.scrollIntoView.call(this,arguments[0]===void 0?!0:arguments[0]);return}const p=f(this),b=p.getBoundingClientRect(),v=this.getBoundingClientRect();p!==t.body?(S.call(this,p,p.scrollLeft+v.left-b.left,p.scrollTop+v.top-b.top),e.getComputedStyle(p).position!=="fixed"&&e.scrollBy({left:b.left,top:b.top,behavior:"smooth"})):e.scrollBy({left:v.left,top:v.top,behavior:"smooth"})}}class zo{constructor(t=[],n){this.timeOffset=0,this.raf=null,this.actions=t,this.speed=n}addAction(t){const n=this.findActionIndex(t);this.actions.splice(n,0,t)}addActions(t){this.actions=this.actions.concat(t)}start(){this.timeOffset=0;let t=performance.now();const{actions:n}=this,r=()=>{const o=performance.now();for(this.timeOffset+=(o-t)*this.speed,t=o;n.length;){const i=n[0];if(this.timeOffset>=i.delay)n.shift(),i.doAction();else break}(n.length>0||this.liveMode)&&(this.raf=requestAnimationFrame(r))};this.raf=requestAnimationFrame(r)}clear(){this.raf&&(cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0}setSpeed(t){this.speed=t}toggleLiveMode(t){this.liveMode=t}isActive(){return this.raf!==null}findActionIndex(t){let n=0,r=this.actions.length-1;for(;n<=r;){const o=Math.floor((n+r)/2);if(this.actions[o].delay<t.delay)n=o+1;else if(this.actions[o].delay>t.delay)r=o-1;else return o+1}return n}}function Nn(e,t){if(e.type===E.IncrementalSnapshot&&e.data.source===I.MouseMove){const n=e.data.positions[0].timeOffset,r=e.timestamp+n;return e.delay=r-t,r-t}return e.delay=e.timestamp-t,e.delay}/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function Tn(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),l=[];try{for(;(t===void 0||t-- >0)&&!(r=i.next()).done;)l.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return l}var Ee;(function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"})(Ee||(Ee={}));var En={type:"xstate.init"};function ht(e){return e===void 0?[]:[].concat(e)}function Ce(e){return{type:"xstate.assign",assignment:e}}function Cn(e,t){return typeof(e=typeof e=="string"&&t&&t[e]?t[e]:e)=="string"?{type:e}:typeof e=="function"?{type:e.name,exec:e}:e}function He(e){return function(t){return e===t}}function In(e){return typeof e=="string"?{type:e}:e}function Mn(e,t){return{value:e,context:t,actions:[],changed:!1,matches:He(e)}}function xn(e,t,n){var r=t,o=!1;return[e.filter(function(i){if(i.type==="xstate.assign"){o=!0;var l=Object.assign({},r);return typeof i.assignment=="function"?l=i.assignment(r,n):Object.keys(i.assignment).forEach(function(a){l[a]=typeof i.assignment[a]=="function"?i.assignment[a](r,n):i.assignment[a]}),r=l,!1}return!0}),r,o]}function Dn(e,t){t===void 0&&(t={});var n=Tn(xn(ht(e.states[e.initial].entry).map(function(l){return Cn(l,t.actions)}),e.context,En),2),r=n[0],o=n[1],i={config:e,_options:t,initialState:{value:e.initial,actions:r,context:o,matches:He(e.initial)},transition:function(l,a){var c,s,u=typeof l=="string"?{value:l,context:e.context}:l,d=u.value,m=u.context,h=In(a),f=e.states[d];if(f.on){var g=ht(f.on[h.type]);try{for(var S=function(R){var X=typeof Symbol=="function"&&Symbol.iterator,w=X&&R[X],y=0;if(w)return w.call(R);if(R&&typeof R.length=="number")return{next:function(){return R&&y>=R.length&&(R=void 0),{value:R&&R[y++],done:!R}}};throw new TypeError(X?"Object is not iterable.":"Symbol.iterator is not defined.")}(g),p=S.next();!p.done;p=S.next()){var b=p.value;if(b===void 0)return Mn(d,m);var v=typeof b=="string"?{target:b}:b,C=v.target,A=v.actions,k=A===void 0?[]:A,F=v.cond,_=F===void 0?function(){return!0}:F,J=C===void 0,H=C??d,B=e.states[H];if(_(m,h)){var Z=Tn(xn((J?ht(k):[].concat(f.exit,k,B.entry).filter(function(R){return R})).map(function(R){return Cn(R,i._options.actions)}),m,h),3),W=Z[0],K=Z[1],Q=Z[2],z=C??d;return{value:z,context:K,actions:W,changed:C!==d||W.length>0||Q,matches:He(z)}}}}catch(R){c={error:R}}finally{try{p&&!p.done&&(s=S.return)&&s.call(S)}finally{if(c)throw c.error}}}return Mn(d,m)}};return i}var Rn=function(e,t){return e.actions.forEach(function(n){var r=n.exec;return r&&r(e.context,t)})};function kn(e){var t=e.initialState,n=Ee.NotStarted,r=new Set,o={_machine:e,send:function(i){n===Ee.Running&&(t=e.transition(t,i),Rn(t,In(i)),r.forEach(function(l){return l(t)}))},subscribe:function(i){return r.add(i),i(t),{unsubscribe:function(){return r.delete(i)}}},start:function(i){if(i){var l=typeof i=="object"?i:{context:e.config.context,value:i};t={value:l.value,actions:[],context:l.context,matches:He(l.value)}}return n=Ee.Running,Rn(t,En),o},stop:function(){return n=Ee.Stopped,r.clear(),o},get state(){return t},get status(){return n}};return o}var Yo=Object.defineProperty,Ho=Object.defineProperties,Xo=Object.getOwnPropertyDescriptors,On=Object.getOwnPropertySymbols,Zo=Object.prototype.hasOwnProperty,Ko=Object.prototype.propertyIsEnumerable,An=(e,t,n)=>t in e?Yo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,mt=(e,t)=>{for(var n in t||(t={}))Zo.call(t,n)&&An(e,n,t[n]);if(On)for(var n of On(t))Ko.call(t,n)&&An(e,n,t[n]);return e},pt=(e,t)=>Ho(e,Xo(t));function Qo(e,t){for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.type===E.Meta&&r.timestamp<=t)return e.slice(n)}return e}function qo(e,{getCastFn:t,applyEventsSynchronously:n,emitter:r}){const o=Dn({id:"player",context:e,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:Ce({lastPlayedEvent:(i,l)=>l.type==="CAST_EVENT"?l.payload.event:i.lastPlayedEvent}),recordTimeOffset:Ce((i,l)=>{let a=i.timeOffset;return"payload"in l&&"timeOffset"in l.payload&&(a=l.payload.timeOffset),pt(mt({},i),{timeOffset:a,baselineTime:i.events[0].timestamp+a})}),play(i){var l;const{timer:a,events:c,baselineTime:s,lastPlayedEvent:u}=i;a.clear();for(const g of c)Nn(g,s);const d=Qo(c,s);let m=u?.timestamp;u?.type===E.IncrementalSnapshot&&u.data.source===I.MouseMove&&(m=u.timestamp+((l=u.data.positions[0])==null?void 0:l.timeOffset)),s<(m||0)&&r.emit(D.PlayBack);const h=new Array,f=new Array;for(const g of d)if(!(m&&m<s&&(g.timestamp<=m||g===u)))if(g.timestamp<s)h.push(g);else{const S=t(g,!1);f.push({doAction:()=>{S()},delay:g.delay})}n(h),r.emit(D.Flush),a.addActions(f),a.start()},pause(i){i.timer.clear()},resetLastPlayedEvent:Ce(i=>pt(mt({},i),{lastPlayedEvent:null})),startLive:Ce({baselineTime:(i,l)=>(i.timer.toggleLiveMode(!0),i.timer.start(),l.type==="TO_LIVE"&&l.payload.baselineTime?l.payload.baselineTime:Date.now())}),addEvent:Ce((i,l)=>{const{baselineTime:a,timer:c,events:s}=i;if(l.type==="ADD_EVENT"){const{event:u}=l.payload;Nn(u,a);let d=s.length-1;if(!s[d]||s[d].timestamp<=u.timestamp)s.push(u);else{let f=-1,g=0;for(;g<=d;){const S=Math.floor((g+d)/2);s[S].timestamp<=u.timestamp?g=S+1:d=S-1}f===-1&&(f=g),s.splice(f,0,u)}const m=u.timestamp<a,h=t(u,m);m?h():c.isActive()&&c.addAction({doAction:()=>{h()},delay:u.delay})}return pt(mt({},i),{events:s})})}});return kn(o)}function Jo(e){const t=Dn({id:"speed",context:e,initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed:(n,r)=>{"payload"in r&&n.timer.setSpeed(r.payload.speed)},recordSpeed:Ce({normalSpeed:n=>n.timer.speed}),restoreSpeed:n=>{n.timer.setSpeed(n.normalSpeed)}}});return kn(t)}const es=e=>[`.${e} { background: currentColor }`,"noscript { display: none !important; }"];var ts=(e,t,n)=>new Promise((r,o)=>{var i=c=>{try{a(n.next(c))}catch(s){o(s)}},l=c=>{try{a(n.throw(c))}catch(s){o(s)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(i,l);a((n=n.apply(e,t)).next())});const Ln=new Map;function _n(e,t){let n=Ln.get(e);return n||(n=new Map,Ln.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}function ue(e,t,n){return r=>ts(this,null,function*(){if(r&&typeof r=="object"&&"rr_type"in r)if(n&&(n.isUnchanged=!1),r.rr_type==="ImageBitmap"&&"args"in r){const o=yield ue(e,t,n)(r.args);return yield createImageBitmap.apply(null,o)}else if("index"in r){if(n||t===null)return r;const{rr_type:o,index:i}=r;return _n(t,o)[i]}else if("args"in r){const{rr_type:o,args:i}=r,l=window[o];return new l(...yield Promise.all(i.map(ue(e,t,n))))}else{if("base64"in r)return Qr(r.base64);if("src"in r){const o=e.get(r.src);if(o)return o;{const i=new Image;return i.src=r.src,e.set(r.src,i),i}}else if("data"in r&&r.rr_type==="Blob"){const o=yield Promise.all(r.data.map(ue(e,t,n)));return new Blob(o,{type:r.type})}}else if(Array.isArray(r))return yield Promise.all(r.map(ue(e,t,n)));return r})}var ns=(e,t,n)=>new Promise((r,o)=>{var i=c=>{try{a(n.next(c))}catch(s){o(s)}},l=c=>{try{a(n.throw(c))}catch(s){o(s)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(i,l);a((n=n.apply(e,t)).next())});function rs(e,t){try{return t===ce.WebGL?e.getContext("webgl")||e.getContext("experimental-webgl"):e.getContext("webgl2")}catch{return null}}const os=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject"];function ss(e,t){if(!(t!=null&&t.constructor))return;const{name:n}=t.constructor;if(!os.includes(n))return;const r=_n(e,n);r.includes(t)||r.push(t)}function is(e){return ns(this,arguments,function*({mutation:t,target:n,type:r,imageMap:o,errorHandler:i}){try{const l=rs(n,r);if(!l)return;if(t.setter){l[t.property]=t.args[0];return}const a=l[t.property],c=yield Promise.all(t.args.map(ue(o,l))),s=a.apply(l,c);ss(l,s)}catch(l){i(t,l)}})}var as=(e,t,n)=>new Promise((r,o)=>{var i=c=>{try{a(n.next(c))}catch(s){o(s)}},l=c=>{try{a(n.throw(c))}catch(s){o(s)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(i,l);a((n=n.apply(e,t)).next())});function ls(e){return as(this,arguments,function*({event:t,mutation:n,target:r,imageMap:o,errorHandler:i}){try{const l=r.getContext("2d");if(n.setter){l[n.property]=n.args[0];return}const a=l[n.property];if(n.property==="drawImage"&&typeof n.args[0]=="string")o.get(t),a.apply(l,n.args);else{const c=yield Promise.all(n.args.map(ue(o,l)));a.apply(l,c)}}catch(l){i(n,l)}})}var cs=(e,t,n)=>new Promise((r,o)=>{var i=c=>{try{a(n.next(c))}catch(s){o(s)}},l=c=>{try{a(n.throw(c))}catch(s){o(s)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(i,l);a((n=n.apply(e,t)).next())});function Fn(e){return cs(this,arguments,function*({event:t,mutation:n,target:r,imageMap:o,canvasEventMap:i,errorHandler:l}){try{const a=i.get(t)||n,c="commands"in a?a.commands:[a];if([ce.WebGL,ce.WebGL2].includes(n.type)){for(let s=0;s<c.length;s++){const u=c[s];yield is({mutation:u,type:n.type,target:r,imageMap:o,errorHandler:l})}return}for(let s=0;s<c.length;s++){const u=c[s];yield ls({event:t,mutation:u,target:r,imageMap:o,errorHandler:l})}}catch(a){l(n,a)}})}var us=Object.defineProperty,ds=Object.defineProperties,hs=Object.getOwnPropertyDescriptors,Pn=Object.getOwnPropertySymbols,ms=Object.prototype.hasOwnProperty,ps=Object.prototype.propertyIsEnumerable,Wn=(e,t,n)=>t in e?us(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ie=(e,t)=>{for(var n in t||(t={}))ms.call(t,n)&&Wn(e,n,t[n]);if(Pn)for(var n of Pn(t))ps.call(t,n)&&Wn(e,n,t[n]);return e},ft=(e,t)=>ds(e,hs(t)),gt=(e,t,n)=>new Promise((r,o)=>{var i=c=>{try{a(n.next(c))}catch(s){o(s)}},l=c=>{try{a(n.throw(c))}catch(s){o(s)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(i,l);a((n=n.apply(e,t)).next())});const fs=10*1e3,gs=5*1e3,ys=wn||jo,yt="[replayer]",vt={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function $n(e){return e.type==E.IncrementalSnapshot&&(e.data.source==I.TouchMove||e.data.source==I.MouseInteraction&&e.data.type==j.TouchStart)}class vs{constructor(t,n){if(this.usingVirtualDom=!1,this.virtualDom=new Te,this.mouseTail=null,this.tailPositions=[],this.emitter=ys(),this.legacy_missingNodeRetryMap={},this.cache=Rt(),this.imageMap=new Map,this.canvasEventMap=new Map,this.mirror=wt(),this.firstFullSnapshot=null,this.newDocumentQueue=[],this.mousePos=null,this.touchActive=null,this.handleResize=a=>{this.iframe.style.display="inherit";for(const c of[this.mouseTail,this.iframe])!c||(c.setAttribute("width",String(a.width)),c.setAttribute("height",String(a.height)))},this.applyEventsSynchronously=a=>{for(const c of a){switch(c.type){case E.DomContentLoaded:case E.Load:case E.Custom:continue;case E.FullSnapshot:case E.Meta:case E.Plugin:case E.IncrementalSnapshot:break}this.getCastFn(c,!0)()}this.touchActive===!0?this.mouse.classList.add("touch-active"):this.touchActive===!1&&this.mouse.classList.remove("touch-active"),this.touchActive=null},this.getCastFn=(a,c=!1)=>{let s;switch(a.type){case E.DomContentLoaded:case E.Load:break;case E.Custom:s=()=>{this.emitter.emit(D.CustomEvent,a)};break;case E.Meta:s=()=>this.emitter.emit(D.Resize,{width:a.data.width,height:a.data.height});break;case E.FullSnapshot:s=()=>{if(this.firstFullSnapshot){if(this.firstFullSnapshot===a){this.firstFullSnapshot=!0;return}}else this.firstFullSnapshot=!0;this.rebuildFullSnapshot(a,c),this.iframe.contentWindow.scrollTo(a.data.initialOffset)};break;case E.IncrementalSnapshot:s=()=>{if(this.applyIncremental(a,c),!c&&(a===this.nextUserInteractionEvent&&(this.nextUserInteractionEvent=null,this.backToNormal()),this.config.skipInactive&&!this.nextUserInteractionEvent)){for(const u of this.service.state.context.events)if(!(u.timestamp<=a.timestamp)&&this.isUserInteraction(u)){u.delay-a.delay>fs*this.speedService.state.context.timer.speed&&(this.nextUserInteractionEvent=u);break}if(this.nextUserInteractionEvent){const u=this.nextUserInteractionEvent.delay-a.delay,d={speed:Math.min(Math.round(u/gs),this.config.maxSpeed)};this.speedService.send({type:"FAST_FORWARD",payload:d}),this.emitter.emit(D.SkipStart,d)}}};break}return()=>{s&&s();for(const d of this.config.plugins||[])d.handler(a,c,{replayer:this});this.service.send({type:"CAST_EVENT",payload:{event:a}});const u=this.service.state.context.events.length-1;if(a===this.service.state.context.events[u]){const d=()=>{u<this.service.state.context.events.length-1||(this.backToNormal(),this.service.send("END"),this.emitter.emit(D.Finish))};a.type===E.IncrementalSnapshot&&a.data.source===I.MouseMove&&a.data.positions.length?setTimeout(()=>{d()},Math.max(0,-a.data.positions[0].timeOffset+50)):d()}this.emitter.emit(D.EventCast,a)}},!(n!=null&&n.liveMode)&&t.length<2)throw new Error("Replayer need at least 2 events.");const r={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,showWarning:!0,showDebug:!1,blockClass:"rr-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:vt,useVirtualDom:!0};this.config=Object.assign({},r,n),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(D.Resize,this.handleResize),this.setupDom(),this.emitter.on(D.Flush,()=>{if(this.usingVirtualDom){const a={mirror:this.mirror,applyCanvas:(c,s,u)=>{Fn({event:c,mutation:s,target:u,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})},applyInput:this.applyInput.bind(this),applyScroll:this.applyScroll.bind(this)};if(ie(this.iframe.contentDocument,this.virtualDom,a,this.virtualDom.mirror),this.virtualDom.destroyTree(),this.usingVirtualDom=!1,Object.keys(this.legacy_missingNodeRetryMap).length)for(const c in this.legacy_missingNodeRetryMap)try{const s=this.legacy_missingNodeRetryMap[c],u=dt(s.node,this.mirror,this.virtualDom.mirror);ie(u,s.node,a,this.virtualDom.mirror),s.node=u}catch(s){this.config.showWarning&&console.warn(s)}}this.mousePos&&this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),this.mousePos=null}),this.emitter.on(D.PlayBack,()=>{this.firstFullSnapshot=null,this.mirror.reset()});const o=new zo([],n?.speed||r.speed);this.service=qo({events:t.map(a=>n&&n.unpackFn?n.unpackFn(a):a).sort((a,c)=>a.timestamp-c.timestamp),timer:o,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe(a=>{this.emitter.emit(D.StateChange,{player:a})}),this.speedService=Jo({normalSpeed:-1,timer:o}),this.speedService.start(),this.speedService.subscribe(a=>{this.emitter.emit(D.StateChange,{speed:a})});const i=this.service.state.context.events.find(a=>a.type===E.Meta),l=this.service.state.context.events.find(a=>a.type===E.FullSnapshot);if(i){const{width:a,height:c}=i.data;setTimeout(()=>{this.emitter.emit(D.Resize,{width:a,height:c})},0)}l&&setTimeout(()=>{this.firstFullSnapshot||(this.firstFullSnapshot=l,this.rebuildFullSnapshot(l),this.iframe.contentWindow.scrollTo(l.data.initialOffset))},1),this.service.state.context.events.find($n)&&this.mouse.classList.add("touch-device")}get timer(){return this.service.state.context.timer}on(t,n){return this.emitter.on(t,n),this}off(t,n){return this.emitter.off(t,n),this}setConfig(t){Object.keys(t).forEach(n=>{t[n],this.config[n]=t[n]}),this.config.skipInactive||this.backToNormal(),typeof t.speed<"u"&&this.speedService.send({type:"SET_SPEED",payload:{speed:t.speed}}),typeof t.mouseTail<"u"&&(t.mouseTail===!1?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))}getMetaData(){const t=this.service.state.context.events[0],n=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:t.timestamp,endTime:n.timestamp,totalTime:n.timestamp-t.timestamp}}getCurrentTime(){return this.timer.timeOffset+this.getTimeOffset()}getTimeOffset(){const{baselineTime:t,events:n}=this.service.state.context;return t-n[0].timestamp}getMirror(){return this.mirror}play(t=0){var n,r;this.service.state.matches("paused")?this.service.send({type:"PLAY",payload:{timeOffset:t}}):(this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:t}})),(r=(n=this.iframe.contentDocument)==null?void 0:n.getElementsByTagName("html")[0])==null||r.classList.remove("rrweb-paused"),this.emitter.emit(D.Start)}pause(t){var n,r;t===void 0&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),typeof t=="number"&&(this.play(t),this.service.send({type:"PAUSE"})),(r=(n=this.iframe.contentDocument)==null?void 0:n.getElementsByTagName("html")[0])==null||r.classList.add("rrweb-paused"),this.emitter.emit(D.Pause)}resume(t=0){console.warn("The 'resume' will be departed in 1.0. Please use 'play' method which has the same interface."),this.play(t),this.emitter.emit(D.Resume)}startLive(t){this.service.send({type:"TO_LIVE",payload:{baselineTime:t}})}addEvent(t){const n=this.config.unpackFn?this.config.unpackFn(t):t;$n(n)&&this.mouse.classList.add("touch-device"),Promise.resolve().then(()=>this.service.send({type:"ADD_EVENT",payload:{event:n}}))}enableInteract(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"}disableInteract(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"}resetCache(){this.cache=Rt()}setupDom(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),this.config.mouseTail!==!1&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");const t=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&t.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",t.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(Bo(this.iframe.contentWindow,this.iframe.contentDocument),rt(this.iframe.contentWindow))}rebuildFullSnapshot(t,n=!1){if(!this.iframe.contentDocument)return console.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&console.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};const r=[];Nr(t.data.node,{doc:this.iframe.contentDocument,afterAppend:l=>{this.collectIframeAndAttachDocument(r,l)},cache:this.cache,mirror:this.mirror});for(const{mutationInQueue:l,builtNode:a}of r)this.attachDocumentToIframe(l,a),this.newDocumentQueue=this.newDocumentQueue.filter(c=>c!==l);const{documentElement:o,head:i}=this.iframe.contentDocument;this.insertStyleRules(o,i),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(D.FullsnapshotRebuilded,t),n||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()}insertStyleRules(t,n){const r=es(this.config.blockClass).concat(this.config.insertStyleRules);if(this.config.pauseAnimation&&r.push("html.rrweb-paused *, html.rrweb-paused *:before, html.rrweb-paused *:after { animation-play-state: paused !important; }"),this.usingVirtualDom){const o=this.virtualDom.createElement("style");this.virtualDom.mirror.add(o,Sn(o,this.virtualDom.unserializedId)),t.insertBefore(o,n);for(let i=0;i<r.length;i++)o.rules.push({cssText:r[i],type:oe.Insert,index:i})}else{const o=document.createElement("style");t.insertBefore(o,n);for(let i=0;i<r.length;i++)o.sheet.insertRule(r[i],i)}}attachDocumentToIframe(t,n){const r=this.usingVirtualDom?this.virtualDom.mirror:this.mirror,o=[];Ge(t.node,{doc:n.contentDocument,mirror:r,hackCss:!0,skipChild:!1,afterAppend:i=>{this.collectIframeAndAttachDocument(o,i);const l=r.getMeta(i);if(l?.type===M.Element&&l?.tagName.toUpperCase()==="HTML"){const{documentElement:a,head:c}=n.contentDocument;this.insertStyleRules(a,c)}},cache:this.cache});for(const{mutationInQueue:i,builtNode:l}of o)this.attachDocumentToIframe(i,l),this.newDocumentQueue=this.newDocumentQueue.filter(a=>a!==i)}collectIframeAndAttachDocument(t,n){if(Se(n,this.mirror)){const r=this.newDocumentQueue.find(o=>o.parentId===this.mirror.getId(n));r&&t.push({mutationInQueue:r,builtNode:n})}}waitForStylesheetLoad(){var t;const n=(t=this.iframe.contentDocument)==null?void 0:t.head;if(n){const r=new Set;let o,i=this.service.state;const l=()=>{i=this.service.state};this.emitter.on(D.Start,l),this.emitter.on(D.Pause,l);const a=()=>{this.emitter.off(D.Start,l),this.emitter.off(D.Pause,l)};n.querySelectorAll('link[rel="stylesheet"]').forEach(c=>{c.sheet||(r.add(c),c.addEventListener("load",()=>{r.delete(c),r.size===0&&o!==-1&&(i.matches("playing")&&this.play(this.getCurrentTime()),this.emitter.emit(D.LoadStylesheetEnd),o&&clearTimeout(o),a())}))}),r.size>0&&(this.service.send({type:"PAUSE"}),this.emitter.emit(D.LoadStylesheetStart),o=setTimeout(()=>{i.matches("playing")&&this.play(this.getCurrentTime()),o=-1,a()},this.config.loadTimeout))}}preloadAllImages(){return gt(this,null,function*(){this.service.state;const t=()=>{this.service.state};this.emitter.on(D.Start,t),this.emitter.on(D.Pause,t);const n=[];for(const r of this.service.state.context.events)r.type===E.IncrementalSnapshot&&r.data.source===I.CanvasMutation&&(n.push(this.deserializeAndPreloadCanvasEvents(r.data,r)),("commands"in r.data?r.data.commands:[r.data]).forEach(o=>{this.preloadImages(o,r)}));return Promise.all(n)})}preloadImages(t,n){if(t.property==="drawImage"&&typeof t.args[0]=="string"&&!this.imageMap.has(n)){const r=document.createElement("canvas"),o=r.getContext("2d"),i=o?.createImageData(r.width,r.height);i?.data,JSON.parse(t.args[0]),o?.putImageData(i,0,0)}}deserializeAndPreloadCanvasEvents(t,n){return gt(this,null,function*(){if(!this.canvasEventMap.has(n)){const r={isUnchanged:!0};if("commands"in t){const o=yield Promise.all(t.commands.map(i=>gt(this,null,function*(){const l=yield Promise.all(i.args.map(ue(this.imageMap,null,r)));return ft(Ie({},i),{args:l})})));r.isUnchanged===!1&&this.canvasEventMap.set(n,ft(Ie({},t),{commands:o}))}else{const o=yield Promise.all(t.args.map(ue(this.imageMap,null,r)));r.isUnchanged===!1&&this.canvasEventMap.set(n,ft(Ie({},t),{args:o}))}}})}applyIncremental(t,n){var r,o,i,l,a,c;const{data:s}=t;switch(s.source){case I.Mutation:{try{this.applyMutation(s,n)}catch(u){this.warn(`Exception in mutation ${u.message||u}`,s)}break}case I.Drag:case I.TouchMove:case I.MouseMove:if(n){const u=s.positions[s.positions.length-1];this.mousePos={x:u.x,y:u.y,id:u.id,debugData:s}}else s.positions.forEach(u=>{const d={doAction:()=>{this.moveAndHover(u.x,u.y,u.id,n,s)},delay:u.timeOffset+t.timestamp-this.service.state.context.baselineTime};this.timer.addAction(d)}),this.timer.addAction({doAction(){},delay:t.delay-((r=s.positions[0])==null?void 0:r.timeOffset)});break;case I.MouseInteraction:{if(s.id===-1||n)break;const u=new Event(j[s.type].toLowerCase()),d=this.mirror.getNode(s.id);if(!d)return this.debugNodeNotFound(s,s.id);this.emitter.emit(D.MouseInteraction,{type:s.type,target:d});const{triggerFocus:m}=this.config;switch(s.type){case j.Blur:"blur"in d&&d.blur();break;case j.Focus:m&&d.focus&&d.focus({preventScroll:!0});break;case j.Click:case j.TouchStart:case j.TouchEnd:n?(s.type===j.TouchStart?this.touchActive=!0:s.type===j.TouchEnd&&(this.touchActive=!1),this.mousePos={x:s.x,y:s.y,id:s.id,debugData:s}):(s.type===j.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(s.x,s.y,s.id,n,s),s.type===j.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):s.type===j.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):s.type===j.TouchEnd&&this.mouse.classList.remove("touch-active"));break;case j.TouchCancel:n?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:d.dispatchEvent(u)}break}case I.Scroll:{if(s.id===-1)break;if(this.usingVirtualDom){const u=this.virtualDom.mirror.getNode(s.id);if(!u)return this.debugNodeNotFound(s,s.id);u.scrollData=s;break}this.applyScroll(s,n);break}case I.ViewportResize:this.emitter.emit(D.Resize,{width:s.width,height:s.height});break;case I.Input:{if(s.id===-1)break;if(this.usingVirtualDom){const u=this.virtualDom.mirror.getNode(s.id);if(!u)return this.debugNodeNotFound(s,s.id);u.inputData=s;break}this.applyInput(s);break}case I.MediaInteraction:{const u=this.usingVirtualDom?this.virtualDom.mirror.getNode(s.id):this.mirror.getNode(s.id);if(!u)return this.debugNodeNotFound(s,s.id);const d=u;try{s.currentTime&&(d.currentTime=s.currentTime),s.volume&&(d.volume=s.volume),s.muted&&(d.muted=s.muted),s.type===he.Pause&&d.pause(),s.type===he.Play&&d.play()}catch(m){this.config.showWarning&&console.warn(`Failed to replay media interactions: ${m.message||m}`)}break}case I.StyleSheetRule:{if(this.usingVirtualDom){const u=this.virtualDom.mirror.getNode(s.id);if(!u)return this.debugNodeNotFound(s,s.id);const d=u.rules;(o=s.adds)==null||o.forEach(({rule:m,index:h})=>d?.push({cssText:m,index:h,type:oe.Insert})),(i=s.removes)==null||i.forEach(({index:m})=>d?.push({index:m,type:oe.Remove}))}else{const u=this.mirror.getNode(s.id);if(!u)return this.debugNodeNotFound(s,s.id);const d=u.sheet;(l=s.adds)==null||l.forEach(({rule:m,index:h})=>{try{if(Array.isArray(h)){const{positions:f,index:g}=at(h);we(d.cssRules,f).insertRule(m,g)}else{const f=h===void 0?void 0:Math.min(h,d.cssRules.length);d.insertRule(m,f)}}catch{}}),(a=s.removes)==null||a.forEach(({index:m})=>{try{if(Array.isArray(m)){const{positions:h,index:f}=at(m);we(d.cssRules,h).deleteRule(f||0)}else d?.deleteRule(m)}catch{}})}break}case I.StyleDeclaration:{if(this.usingVirtualDom){const u=this.virtualDom.mirror.getNode(s.id);if(!u)return this.debugNodeNotFound(s,s.id);const d=u.rules;s.set&&d.push(Ie({type:oe.SetProperty,index:s.index},s.set)),s.remove&&d.push(Ie({type:oe.RemoveProperty,index:s.index},s.remove))}else{const u=this.mirror.getNode(s.id);if(!u)return this.debugNodeNotFound(s,s.id);const d=u.sheet;s.set&&we(d.rules,s.index).style.setProperty(s.set.property,s.set.value,s.set.priority),s.remove&&we(d.rules,s.index).style.removeProperty(s.remove.property)}break}case I.CanvasMutation:{if(!this.config.UNSAFE_replayCanvas)return;if(this.usingVirtualDom){const u=this.virtualDom.mirror.getNode(s.id);if(!u)return this.debugNodeNotFound(s,s.id);u.canvasMutations.push({event:t,mutation:s})}else{const u=this.mirror.getNode(s.id);if(!u)return this.debugNodeNotFound(s,s.id);Fn({event:t,mutation:s,target:u,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})}break}case I.Font:{try{const u=new FontFace(s.family,s.buffer?new Uint8Array(JSON.parse(s.fontSource)):s.fontSource,s.descriptors);(c=this.iframe.contentDocument)==null||c.fonts.add(u)}catch(u){this.config.showWarning&&console.warn(u)}break}}}applyMutation(t,n){if(this.config.useVirtualDom&&!this.usingVirtualDom&&n&&(this.usingVirtualDom=!0,Vo(this.iframe.contentDocument,this.mirror,this.virtualDom),Object.keys(this.legacy_missingNodeRetryMap).length))for(const s in this.legacy_missingNodeRetryMap)try{const u=this.legacy_missingNodeRetryMap[s],d=bn(u.node,this.virtualDom,this.mirror);d&&(u.node=d)}catch(u){this.config.showWarning&&console.warn(u)}const r=this.usingVirtualDom?this.virtualDom.mirror:this.mirror;t.removes.forEach(s=>{var u;const d=r.getNode(s.id);if(!d)return t.removes.find(h=>h.id===s.parentId)?void 0:this.warnNodeNotFound(t,s.id);let m=r.getNode(s.parentId);if(!m)return this.warnNodeNotFound(t,s.parentId);if(s.isShadow&&Ae(m)&&(m=m.shadowRoot),r.removeNodeFromMap(d),m)try{m.removeChild(d),this.usingVirtualDom&&d.nodeName==="#text"&&m.nodeName==="STYLE"&&((u=m.rules)==null?void 0:u.length)>0&&(m.rules=[])}catch(h){if(h instanceof DOMException)this.warn("parent could not remove child in mutation",m,d,t);else throw h}});const o=Ie({},this.legacy_missingNodeRetryMap),i=[],l=s=>{let u=null;return s.nextId&&(u=r.getNode(s.nextId)),s.nextId!==null&&s.nextId!==void 0&&s.nextId!==-1&&!u},a=s=>{var u;if(!this.iframe.contentDocument)return console.warn("Looks like your replayer has been destroyed.");let d=r.getNode(s.parentId);if(!d)return s.node.type===M.Document?this.newDocumentQueue.push(s):i.push(s);s.node.isShadow&&(Ae(d)||d.attachShadow({mode:"open"}),d=d.shadowRoot);let m=null,h=null;if(s.previousId&&(m=r.getNode(s.previousId)),s.nextId&&(h=r.getNode(s.nextId)),l(s))return i.push(s);if(s.node.rootId&&!r.getNode(s.node.rootId))return;const f=s.node.rootId?r.getNode(s.node.rootId):this.usingVirtualDom?this.virtualDom:this.iframe.contentDocument;if(Se(d,r)){this.attachDocumentToIframe(s,d);return}const g=Ge(s.node,{doc:f,mirror:r,skipChild:!0,hackCss:!0,cache:this.cache});if(s.previousId===-1||s.nextId===-1){o[s.node.id]={node:g,mutation:s};return}const S=r.getMeta(d);if(S&&S.type===M.Element&&S.tagName==="textarea"&&s.node.type===M.Text){const p=Array.isArray(d.childNodes)?d.childNodes:Array.from(d.childNodes);for(const b of p)b.nodeType===d.TEXT_NODE&&d.removeChild(b)}if(m&&m.nextSibling&&m.nextSibling.parentNode)d.insertBefore(g,m.nextSibling);else if(h&&h.parentNode)d.contains(h)?d.insertBefore(g,h):d.insertBefore(g,null);else{if(d===f)for(;f.firstChild;)f.removeChild(f.firstChild);d.appendChild(g)}if(this.usingVirtualDom&&g.nodeName==="#text"&&d.nodeName==="STYLE"&&((u=d.rules)==null?void 0:u.length)>0&&(d.rules=[]),Se(g,this.mirror)){const p=this.mirror.getId(g),b=this.newDocumentQueue.find(v=>v.parentId===p);b&&(this.attachDocumentToIframe(b,g),this.newDocumentQueue=this.newDocumentQueue.filter(v=>v!==b))}(s.previousId||s.nextId)&&this.legacy_resolveMissingNode(o,d,g,s)};t.adds.forEach(s=>{a(s)});const c=Date.now();for(;i.length;){const s=Ot(i);if(i.length=0,Date.now()-c>500){this.warn("Timeout in the loop, please check the resolve tree data:",s);break}for(const u of s)r.getNode(u.value.parentId)?ot(u,d=>{a(d)}):this.debug("Drop resolve tree since there is no parent for the root node.",u)}Object.keys(o).length&&Object.assign(this.legacy_missingNodeRetryMap,o),At(t.texts).forEach(s=>{var u;const d=r.getNode(s.id);if(!d)return t.removes.find(m=>m.id===s.id)?void 0:this.warnNodeNotFound(t,s.id);if(d.textContent=s.value,this.usingVirtualDom){const m=d.parentNode;((u=m?.rules)==null?void 0:u.length)>0&&(m.rules=[])}}),t.attributes.forEach(s=>{const u=r.getNode(s.id);if(!u)return t.removes.find(d=>d.id===s.id)?void 0:this.warnNodeNotFound(t,s.id);for(const d in s.attributes)if(typeof d=="string"){const m=s.attributes[d];if(m===null)u.removeAttribute(d);else if(typeof m=="string")try{u.setAttribute(d,m)}catch(h){this.config.showWarning&&console.warn("An error occurred may due to the checkout feature.",h)}else if(d==="style"){const h=m,f=u;for(const g in h)if(h[g]===!1)f.style.removeProperty(g);else if(h[g]instanceof Array){const S=h[g];f.style.setProperty(g,S[0],S[1])}else{const S=h[g];f.style.setProperty(g,S)}}}})}applyScroll(t,n){const r=this.mirror.getNode(t.id);if(!r)return this.debugNodeNotFound(t,t.id);const o=this.mirror.getMeta(r);if(r===this.iframe.contentDocument)this.iframe.contentWindow.scrollTo({top:t.y,left:t.x,behavior:n?"auto":"smooth"});else if(o?.type===M.Document)r.defaultView.scrollTo({top:t.y,left:t.x,behavior:n?"auto":"smooth"});else try{r.scrollTop=t.y,r.scrollLeft=t.x}catch{}}applyInput(t){const n=this.mirror.getNode(t.id);if(!n)return this.debugNodeNotFound(t,t.id);try{n.checked=t.isChecked,n.value=t.text}catch{}}legacy_resolveMissingNode(t,n,r,o){const{previousId:i,nextId:l}=o,a=i&&t[i],c=l&&t[l];if(a){const{node:s,mutation:u}=a;n.insertBefore(s,r),delete t[u.node.id],delete this.legacy_missingNodeRetryMap[u.node.id],(u.previousId||u.nextId)&&this.legacy_resolveMissingNode(t,n,s,u)}if(c){const{node:s,mutation:u}=c;n.insertBefore(s,r.nextSibling),delete t[u.node.id],delete this.legacy_missingNodeRetryMap[u.node.id],(u.previousId||u.nextId)&&this.legacy_resolveMissingNode(t,n,s,u)}}moveAndHover(t,n,r,o,i){const l=this.mirror.getNode(r);if(!l)return this.debugNodeNotFound(i,r);const a=it(l,this.iframe),c=t*a.absoluteScale+a.x,s=n*a.absoluteScale+a.y;this.mouse.style.left=`${c}px`,this.mouse.style.top=`${s}px`,o||this.drawMouseTail({x:c,y:s}),this.hoverElements(l)}drawMouseTail(t){if(!this.mouseTail)return;const{lineCap:n,lineWidth:r,strokeStyle:o,duration:i}=this.config.mouseTail===!0?vt:Object.assign({},vt,this.config.mouseTail),l=()=>{if(!this.mouseTail)return;const a=this.mouseTail.getContext("2d");!a||!this.tailPositions.length||(a.clearRect(0,0,this.mouseTail.width,this.mouseTail.height),a.beginPath(),a.lineWidth=r,a.lineCap=n,a.strokeStyle=o,a.moveTo(this.tailPositions[0].x,this.tailPositions[0].y),this.tailPositions.forEach(c=>a.lineTo(c.x,c.y)),a.stroke())};this.tailPositions.push(t),l(),setTimeout(()=>{this.tailPositions=this.tailPositions.filter(a=>a!==t),l()},i/this.speedService.state.context.timer.speed)}hoverElements(t){var n;(n=this.iframe.contentDocument)==null||n.querySelectorAll(".\\:hover").forEach(o=>{o.classList.remove(":hover")});let r=t;for(;r;)r.classList&&r.classList.add(":hover"),r=r.parentElement}isUserInteraction(t){return t.type!==E.IncrementalSnapshot?!1:t.data.source>I.Mutation&&t.data.source<=I.Input}backToNormal(){this.nextUserInteractionEvent=null,!this.speedService.state.matches("normal")&&(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(D.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))}warnNodeNotFound(t,n){this.warn(`Node with id '${n}' not found. `,t)}warnCanvasMutationFailed(t,n){this.warn("Has error on canvas update",n,"canvas mutation:",t)}debugNodeNotFound(t,n){this.debug(yt,`Node with id '${n}' not found. `,t)}warn(...t){!this.config.showWarning||console.warn(yt,...t)}debug(...t){!this.config.showDebug||console.log(yt,...t)}}const{addCustomEvent:bs}=pe,{freezePage:Ss}=pe;return q.EventType=E,q.IncrementalSource=I,q.MouseInteractions=j,q.Replayer=vs,q.ReplayerEvents=D,q.addCustomEvent=bs,q.freezePage=Ss,q.record=pe,q.utils=Tr,Object.defineProperty(q,"__esModule",{value:!0}),q}({});
//# sourceMappingURL=rrweb.min.js.map
